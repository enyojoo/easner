exports.id=391,exports.ids=[391],exports.modules={21507:(e,t,a)=>{Promise.resolve().then(a.bind(a,2802))},2802:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(10326),r=a(47427),i=a(77506);function n({children:e}){let{isChecking:t}=(0,r.b)({requireAuth:!0,adminOnly:!0,redirectTo:"/admin/login"});return t?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsx(i.Z,{className:"h-8 w-8 animate-spin text-easner-primary"})}):s.jsx(s.Fragment,{children:e})}},24166:(e,t,a)=>{"use strict";a.d(t,{O:()=>i});var s=a(10326);let r={name:"Easner",logo:"https://cldup.com/cwHk7-kSb4.svg"};function i({href:e,className:t="",size:a="md"}){return s.jsx("img",{src:r.logo||"/placeholder.svg",alt:`${r.name} Logo`,className:`w-auto object-contain ${{sm:"h-4",md:"h-6",lg:"h-7"}[a]} ${t}`})}},37706:(e,t,a)=>{"use strict";a.d(t,{Q:()=>p});var s=a(10326),r=a(17577),i=a(90434),n=a(35047),c=a(24319),l=a(28916),o=a(24061),d=a(17069),u=a(88378),h=a(94019),m=a(71810),f=a(90748),y=a(24166),g=a(90772);let x=[{name:"Dashboard",href:"/admin/dashboard",icon:c.Z},{name:"Transactions",href:"/admin/transactions",icon:l.Z},{name:"Users",href:"/admin/users",icon:o.Z},{name:"Rates",href:"/admin/rates",icon:d.Z},{name:"Settings",href:"/admin/settings",icon:u.Z}];function p({children:e}){let t=(0,n.usePathname)(),a=(0,n.useRouter)(),[c,l]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[c&&s.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",children:s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>l(!1)})}),s.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0 ${c?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 h-16 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(y.O,{size:"sm"}),s.jsx("span",{className:"text-sm text-easner-primary font-medium",children:"Admin"})]}),s.jsx(g.z,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:()=>l(!1),children:s.jsx(h.Z,{className:"h-5 w-5"})})]}),s.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:x.map(e=>{let a=t===e.href;return(0,s.jsxs)(i.default,{href:e.href,className:`flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${a?"bg-easner-primary-100 text-easner-primary":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,onClick:()=>l(!1),children:[s.jsx(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})}),s.jsx("div",{className:"px-4 py-4 border-t border-gray-200",children:(0,s.jsxs)(g.z,{variant:"ghost",className:"w-full justify-start text-gray-600 hover:text-gray-900 hover:bg-gray-100",onClick:()=>{a.push("/admin/login")},children:[s.jsx(m.Z,{className:"mr-3 h-5 w-5"}),"Logout"]})})]})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 px-4 h-16 flex items-center sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[s.jsx(g.z,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:()=>l(!0),children:s.jsx(f.Z,{className:"h-5 w-5"})}),s.jsx("div",{className:"flex-1"})]})}),s.jsx("main",{className:"flex-1 overflow-y-auto",children:e})]})]})}},15940:(e,t,a)=>{"use strict";a.d(t,{RM:()=>l,SC:()=>o,iA:()=>n,pj:()=>u,ss:()=>d,xD:()=>c});var s=a(10326),r=a(17577),i=a(77863);let n=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:a,className:(0,i.cn)("w-full caption-bottom text-sm",e),...t})}));n.displayName="Table";let c=r.forwardRef(({className:e,...t},a)=>s.jsx("thead",{ref:a,className:(0,i.cn)("[&_tr]:border-b",e),...t}));c.displayName="TableHeader";let l=r.forwardRef(({className:e,...t},a)=>s.jsx("tbody",{ref:a,className:(0,i.cn)("[&_tr:last-child]:border-0",e),...t}));l.displayName="TableBody",r.forwardRef(({className:e,...t},a)=>s.jsx("tfoot",{ref:a,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let o=r.forwardRef(({className:e,...t},a)=>s.jsx("tr",{ref:a,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));o.displayName="TableRow";let d=r.forwardRef(({className:e,...t},a)=>s.jsx("th",{ref:a,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));d.displayName="TableHead";let u=r.forwardRef(({className:e,...t},a)=>s.jsx("td",{ref:a,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",r.forwardRef(({className:e,...t},a)=>s.jsx("caption",{ref:a,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},47427:(e,t,a)=>{"use strict";a.d(t,{b:()=>n});var s=a(17577),r=a(35047),i=a(51813);function n(e={}){let{user:t,userProfile:a,loading:n,isAdmin:c}=(0,i.a)();(0,r.useRouter)(),(0,r.usePathname)();let[l,o]=(0,s.useState)(!0),[d,u]=(0,s.useState)(!1),{requireAuth:h=!0,adminOnly:m=!1,redirectTo:f="/login"}=e;return{isChecking:n||l,isAuthorized:d,user:t,userProfile:a,isAdmin:c}}},22068:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var s=a(35442);class r{constructor(){this.data=null,this.loading=!1,this.refreshInterval=null,this.listeners=new Set,this.initialized=!1,this.initialize()}async initialize(){this.initialized||(this.initialized=!0,this.loadData().catch(console.error),this.startAutoRefresh())}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(){this.listeners.forEach(e=>e())}getData(){return this.data}isLoading(){return this.loading&&!this.data}async loadData(){this.loading=!0;try{let[e,t,a,s,r]=await Promise.all([this.loadUsers(),this.loadTransactions(),this.loadCurrencies(),this.loadExchangeRates(),this.getAdminBaseCurrency()]),i=await this.calculateStats(e,t,r),n=this.processRecentActivity(t.slice(0,10)),c=this.processCurrencyPairs(t.filter(e=>"completed"===e.status));return this.data={users:e,transactions:t,currencies:a,exchangeRates:s,baseCurrency:r,stats:i,recentActivity:n,currencyPairs:c,lastUpdated:Date.now()},this.notify(),this.data}finally{this.loading=!1}}async loadUsers(){let{data:e,error:t}=await s.OQ.from("users").select("*").order("created_at",{ascending:!1});if(t)throw t;return await Promise.all((e||[]).map(async e=>{let{data:t}=await s.OQ.from("transactions").select("send_amount, send_currency, status").eq("user_id",e.id),a=t?.length||0,r=(t||[]).reduce((e,t)=>{let a=Number(t.send_amount);switch(t.send_currency){case"RUB":a*=.011;break;case"USD":a*=1650;break;case"EUR":a*=1750;break;case"GBP":a*=2e3}return e+a},0);return{...e,totalTransactions:a,totalVolume:r}}))}async loadTransactions(){let{data:e,error:t}=await s.OQ.from("transactions").select(`
        *,
        user:users(first_name, last_name, email),
        recipient:recipients(full_name, bank_name, account_number)
      `).order("created_at",{ascending:!1}).limit(200);if(t)throw t;return e||[]}async loadCurrencies(){let{data:e,error:t}=await s.OQ.from("currencies").select("*").order("code");if(t)throw t;return e||[]}async loadExchangeRates(){let{data:e,error:t}=await s.OQ.from("exchange_rates").select(`
      *,
      from_currency_info:currencies!exchange_rates_from_currency_fkey(code, name, symbol),
      to_currency_info:currencies!exchange_rates_to_currency_fkey(code, name, symbol)
    `);if(t)throw t;return e||[]}async calculateStats(e,t,a){let s=e.length,r=e.filter(e=>"active"===e.status).length,i=e.filter(e=>"verified"===e.verification_status).length,n=t.length,c=t.filter(e=>"pending"===e.status||"processing"===e.status).length,l=t.filter(e=>"completed"===e.status);return{totalUsers:s,activeUsers:r,verifiedUsers:i,totalTransactions:n,totalVolume:await this.calculateVolumeInBaseCurrency(l,a),pendingTransactions:c}}async getAdminBaseCurrency(){try{let{data:e,error:t}=await s.OQ.from("system_settings").select("value").eq("key","base_currency").single();if(t||!e)return"NGN";return e.value}catch{return"NGN"}}async calculateVolumeInBaseCurrency(e,t){let a=0;for(let s of e){let e=Number(s.send_amount),r=s.send_currency;r===t?a+=e:a+=await this.convertCurrency(e,r,t)}return a}async convertCurrency(e,t,a){try{let{data:r,error:i}=await s.OQ.from("exchange_rates").select("rate").eq("from_currency",t).eq("to_currency",a).eq("status","active").single();if(i||!r)return this.convertWithFallbackRates(e,t,a);return e*r.rate}catch{return this.convertWithFallbackRates(e,t,a)}}convertWithFallbackRates(e,t,a){let s={NGN:{RUB:.011,USD:61e-5,EUR:57e-5,GBP:5e-4},RUB:{NGN:91,USD:.055,EUR:.052,GBP:.045},USD:{NGN:1650,RUB:18.2,EUR:.93,GBP:.82},EUR:{NGN:1750,RUB:19.5,USD:1.08,GBP:.88},GBP:{NGN:2e3,RUB:22.2,USD:1.22,EUR:1.14}};if(t===a)return e;let r=s[t]?.[a];if(r)return e*r;let i=s[t]?.USD,n=s.USD?.[a];return i&&n?e*i*n:e}processRecentActivity(e){return e.map(e=>({id:e.id,type:this.getActivityType(e.status),message:this.getActivityMessage(e),user:e.user?`${e.user.first_name} ${e.user.last_name}`:void 0,amount:this.formatCurrency(e.send_amount,e.send_currency),time:this.getRelativeTime(e.created_at),status:this.getActivityStatus(e.status)}))}processCurrencyPairs(e){let t={};e.forEach(e=>{let a=`${e.send_currency} → ${e.receive_currency}`;t[a]||(t[a]={volume:0,count:0}),t[a].volume+=e.send_amount,t[a].count+=1});let a=Object.values(t).reduce((e,t)=>e+t.volume,0);return Object.entries(t).map(([e,t])=>({pair:e,volume:a>0?t.volume/a*100:0,transactions:t.count})).sort((e,t)=>t.volume-e.volume).slice(0,4)}getActivityType(e){switch(e){case"completed":return"transaction_completed";case"failed":return"transaction_failed";default:return"transaction_pending"}}getActivityMessage(e){switch(e.status){case"completed":return`Transaction ${e.transaction_id} completed successfully`;case"failed":return`Transaction ${e.transaction_id} failed`;case"pending":return`New transaction ${e.transaction_id} awaiting verification`;default:return`Transaction ${e.transaction_id} is being processed`}}getActivityStatus(e){switch(e){case"completed":return"success";case"failed":return"error";case"pending":case"processing":return"warning";default:return"info"}}getRelativeTime(e){let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/6e4);return a<1?"Just now":a<60?`${a} minutes ago`:a<1440?`${Math.floor(a/60)} hours ago`:`${Math.floor(a/1440)} days ago`}formatCurrency(e,t="NGN"){return`${({NGN:"₦",RUB:"₽",USD:"$",EUR:"€",GBP:"\xa3"})[t]||""}${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}startAutoRefresh(){this.refreshInterval=setInterval(()=>{this.loadData().catch(console.error)},3e5)}async updateTransactionStatus(e,t){try{let{error:a}=await s.OQ.from("transactions").update({status:t,updated_at:new Date().toISOString()}).eq("transaction_id",e);if(a)throw a;this.data&&(this.data.transactions=this.data.transactions.map(a=>a.transaction_id===e?{...a,status:t}:a),this.data.stats=await this.calculateStats(this.data.users,this.data.transactions,this.data.baseCurrency),this.data.recentActivity=this.processRecentActivity(this.data.transactions.slice(0,10)),this.notify())}catch(e){throw e}}async updateUserStatus(e,t){try{let{error:a}=await s.OQ.from("users").update({status:t}).eq("id",e);if(a)throw a;this.data&&(this.data.users=this.data.users.map(a=>a.id===e?{...a,status:t}:a),this.data.stats=await this.calculateStats(this.data.users,this.data.transactions,this.data.baseCurrency),this.notify())}catch(e){throw e}}async updateUserVerification(e,t){try{let{error:a}=await s.OQ.from("users").update({verification_status:t}).eq("id",e);if(a)throw a;this.data&&(this.data.users=this.data.users.map(a=>a.id===e?{...a,verification_status:t}:a),this.data.stats=await this.calculateStats(this.data.users,this.data.transactions,this.data.baseCurrency),this.notify())}catch(e){throw e}}async updateCurrencyStatus(e,t){try{let{error:a}=await s.OQ.from("currencies").update({status:t,updated_at:new Date().toISOString()}).eq("id",e);if(a)throw a;this.data&&(this.data.currencies=this.data.currencies.map(a=>a.id===e?{...a,status:t,updated_at:new Date().toISOString()}:a),this.notify())}catch(e){throw e}}async updateExchangeRates(e){try{let{error:t}=await s.OQ.from("exchange_rates").upsert(e,{onConflict:"from_currency,to_currency",ignoreDuplicates:!1});if(t)throw t;let a=await this.loadExchangeRates();this.data&&(this.data.exchangeRates=a,this.notify())}catch(e){throw e}}async addCurrency(e){try{let{data:t,error:a}=await s.OQ.from("currencies").insert(e).select().single();if(a)throw a;return this.data&&(this.data.currencies=[...this.data.currencies,t],this.notify()),t}catch(e){throw e}}async deleteCurrency(e){try{let t=this.data?.currencies.find(t=>t.id===e);if(!t)return;let{error:a}=await s.OQ.from("exchange_rates").delete().or(`from_currency.eq.${t.code},to_currency.eq.${t.code}`);if(a)throw a;let{error:r}=await s.OQ.from("currencies").delete().eq("id",e);if(r)throw r;this.data&&(this.data.currencies=this.data.currencies.filter(t=>t.id!==e),this.data.exchangeRates=this.data.exchangeRates.filter(e=>e.from_currency!==t.code&&e.to_currency!==t.code),this.notify())}catch(e){throw e}}async updateCurrencies(){try{let[e,t]=await Promise.all([this.loadCurrencies(),this.loadExchangeRates()]);this.data&&(this.data.currencies=e,this.data.exchangeRates=t,this.notify())}catch(e){throw e}}async refreshDataForBaseCurrencyChange(){try{await this.loadData()}catch(e){console.error("Error refreshing data for base currency change:",e)}}destroy(){this.refreshInterval&&clearInterval(this.refreshInterval),this.listeners.clear()}}let i=new r},90596:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`D:\Users\enyoc\Documents\Dev\easner\app\admin\layout.tsx#default`)}};