"use strict";exports.id=745,exports.ids=[745],exports.modules={24166:(e,t,a)=>{a.d(t,{O:()=>n});var r=a(10326);let s={name:"Easner",logo:"https://cldup.com/cwHk7-kSb4.svg"};function n({href:e,className:t="",size:a="md"}){return r.jsx("img",{src:s.logo||"/placeholder.svg",alt:`${s.name} Logo`,className:`w-auto object-contain ${{sm:"h-4",md:"h-6",lg:"h-7"}[a]} ${t}`})}},60097:(e,t,a)=>{a.d(t,{$F:()=>u,AW:()=>f,Xi:()=>m,h_:()=>d});var r=a(10326),s=a(17577),n=a(79313),i=a(39183),o=a(32933),c=a(53982),l=a(77863);let d=n.fC,u=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,s.forwardRef(({className:e,inset:t,children:a,...s},o)=>(0,r.jsxs)(n.fF,{ref:o,className:(0,l.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...s,children:[a,r.jsx(i.Z,{className:"ml-auto"})]})).displayName=n.fF.displayName,s.forwardRef(({className:e,...t},a)=>r.jsx(n.tu,{ref:a,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})).displayName=n.tu.displayName;let f=s.forwardRef(({className:e,sideOffset:t=4,...a},s)=>r.jsx(n.Uv,{children:r.jsx(n.VY,{ref:s,sideOffset:t,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));f.displayName=n.VY.displayName;let m=s.forwardRef(({className:e,inset:t,...a},s)=>r.jsx(n.ck,{ref:s,className:(0,l.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...a}));m.displayName=n.ck.displayName,s.forwardRef(({className:e,children:t,checked:a,...s},i)=>(0,r.jsxs)(n.oC,{ref:i,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:a,...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(n.wU,{children:r.jsx(o.Z,{className:"h-4 w-4"})})}),t]})).displayName=n.oC.displayName,s.forwardRef(({className:e,children:t,...a},s)=>(0,r.jsxs)(n.Rk,{ref:s,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(n.wU,{children:r.jsx(c.Z,{className:"h-2 w-2 fill-current"})})}),t]})).displayName=n.Rk.displayName,s.forwardRef(({className:e,inset:t,...a},s)=>r.jsx(n.__,{ref:s,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...a})).displayName=n.__.displayName,s.forwardRef(({className:e,...t},a)=>r.jsx(n.Z0,{ref:a,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.Z0.displayName},38760:(e,t,a)=>{a.d(t,{yE:()=>c,tE:()=>l,Ov:()=>d,W4:()=>o});var r=a(35442);class s{set(e,t,a=this.DEFAULT_TTL){this.cache.set(e,{data:t,timestamp:Date.now(),ttl:a,isStale:!1})}get(e){let t=this.cache.get(e);if(!t)return null;let a=Date.now()-t.timestamp;return a>this.STALE_WHILE_REVALIDATE_TTL?(this.cache.delete(e),null):(a>t.ttl&&(t.isStale=!0),t.data)}isStale(e){let t=this.cache.get(e);return!t||Date.now()-t.timestamp>t.ttl}getWithRefresh(e,t){let a=this.get(e);return a&&this.isStale(e)&&!this.refreshPromises.has(e)&&this.refreshPromises.set(e,t().then(t=>(this.set(e,t),t)).catch(t=>(console.error(`Background refresh failed for ${e}:`,t),a)).finally(()=>{this.refreshPromises.delete(e)})),a}invalidate(e){this.cache.delete(e),this.refreshPromises.delete(e)}invalidatePattern(e){let t=new RegExp(e);for(let e of this.cache.keys())t.test(e)&&(this.cache.delete(e),this.refreshPromises.delete(e))}clear(){this.cache.clear(),this.refreshPromises.clear()}async forceRefresh(e,t){this.invalidate(e);let a=await t();return this.set(e,a),a}getStats(){return{size:this.cache.size,refreshing:this.refreshPromises.size,keys:Array.from(this.cache.keys())}}constructor(){this.cache=new Map,this.DEFAULT_TTL=12e4,this.STALE_WHILE_REVALIDATE_TTL=3e5,this.refreshPromises=new Map}}let n=new s,i={CURRENCIES:"currencies",EXCHANGE_RATES:"exchange_rates",USER_RECIPIENTS:e=>`user_recipients_${e}`,USER_TRANSACTIONS:e=>`user_transactions_${e}`,TRANSACTION:e=>`transaction_${e}`,USER_PROFILE:e=>`user_profile_${e}`},o={async findByEmail(e){let{data:t,error:a}=await r.OQ.from("users").select("*").eq("email",e).single();if(a&&"PGRST116"!==a.code)throw a;return t},async updateProfile(e,t){let{data:a,error:s}=await r.OQ.from("users").update({first_name:t.firstName,last_name:t.lastName,phone:t.phone,base_currency:t.baseCurrency,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return n.invalidate(i.USER_PROFILE(e)),a},async getStats(){let{data:e}=await r.OQ.from("users").select("id",{count:"exact"}),{data:t}=await r.OQ.from("users").select("id",{count:"exact"}).eq("status","active"),{data:a}=await r.OQ.from("users").select("id",{count:"exact"}).eq("verification_status","verified");return{total:e?.length||0,active:t?.length||0,verified:a?.length||0}}},c={async getAll(){let e=async()=>{let{data:e,error:t}=await r.OQ.from("currencies").select("id, code, name, symbol, flag_svg, status, created_at, updated_at").eq("status","active").order("code");if(t)throw t;return e?.map(e=>({...e,flag:e.flag_svg}))||[]},t=n.getWithRefresh(i.CURRENCIES,e);if(t)return t;let a=await e();return n.set(i.CURRENCIES,a,3e5),a},async getExchangeRates(){let e=async()=>{let{data:e,error:t}=await r.OQ.from("exchange_rates").select(`
          *,
          from_currency_info:currencies!exchange_rates_from_currency_fkey(id, code, name, symbol, flag_svg),
          to_currency_info:currencies!exchange_rates_to_currency_fkey(id, code, name, symbol, flag_svg)
        `).eq("status","active");if(t)throw t;return e?.map(e=>({...e,from_currency_info:e.from_currency_info?{...e.from_currency_info,flag:e.from_currency_info.flag_svg}:void 0,to_currency_info:e.to_currency_info?{...e.to_currency_info,flag:e.to_currency_info.flag_svg}:void 0}))||[]},t=n.getWithRefresh(i.EXCHANGE_RATES,e);if(t)return t;let a=await e();return n.set(i.EXCHANGE_RATES,a,12e4),a},async getRate(e,t){let{data:a,error:s}=await r.OQ.from("exchange_rates").select("*").eq("from_currency",e).eq("to_currency",t).eq("status","active").single();if(s&&"PGRST116"!==s.code)throw s;return a},async updateRate(e,t,a,s="free",o=0){let{data:c,error:l}=await r.OQ.from("exchange_rates").upsert({from_currency:e,to_currency:t,rate:a,fee_type:s,fee_amount:o,status:"active",updated_at:new Date().toISOString()}).select().single();if(l)throw l;return n.invalidate(i.EXCHANGE_RATES),c}},l={async create(e,t){let{data:a,error:s}=await r.OQ.from("recipients").insert({user_id:e,full_name:t.fullName,account_number:t.accountNumber,bank_name:t.bankName,phone_number:t.phoneNumber,currency:t.currency}).select().single();if(s)throw s;return n.invalidate(i.USER_RECIPIENTS(e)),a},async getByUserId(e){let t=async()=>{let{data:t,error:a}=await r.OQ.from("recipients").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(a)throw a;return t||[]},a=n.getWithRefresh(i.USER_RECIPIENTS(e),t);if(a)return a;let s=await t();return n.set(i.USER_RECIPIENTS(e),s,12e4),s},async update(e,t){let{data:a,error:s}=await r.OQ.from("recipients").update({full_name:t.fullName,account_number:t.accountNumber,bank_name:t.bankName,phone_number:t.phoneNumber}).eq("id",e).select().single();if(s)throw s;return n.invalidatePattern("user_recipients_"),a},async delete(e){let{error:t}=await r.OQ.from("recipients").delete().eq("id",e);if(t)throw t;n.invalidatePattern("user_recipients_")}},d={async create(e){let t=`NP${Date.now()}`;try{let a=new Promise((e,t)=>setTimeout(()=>t(Error("Transaction creation timeout")),15e3)),s=r.OQ.from("transactions").insert({transaction_id:t,user_id:e.userId,recipient_id:e.recipientId,send_amount:e.sendAmount,send_currency:e.sendCurrency,receive_amount:e.receiveAmount,receive_currency:e.receiveCurrency,exchange_rate:e.exchangeRate,fee_amount:e.feeAmount,fee_type:e.feeType,total_amount:e.totalAmount,reference:e.reference}).select().single(),{data:o,error:c}=await Promise.race([s,a]);if(c)throw c;return n.invalidate(i.USER_TRANSACTIONS(e.userId)),o}catch(e){throw console.error("Transaction creation error:",e),Error("Failed to create transaction. Please check your connection and try again.")}},async getByUserId(e,t=20){let a=async()=>{let{data:a,error:s}=await r.OQ.from("transactions").select(`
          *,
          recipient:recipients(*)
        `).eq("user_id",e).order("created_at",{ascending:!1}).limit(t);if(s)throw s;return a||[]},s=n.getWithRefresh(i.USER_TRANSACTIONS(e),a);if(s)return s;let o=await a();return n.set(i.USER_TRANSACTIONS(e),o,6e4),o},async getById(e){let t=async()=>{let{data:t,error:a}=await r.OQ.from("transactions").select(`
          *,
          recipient:recipients(*),
          user:users(first_name, last_name, email)
        `).eq("transaction_id",e).single();if(a)throw a;return t},a=n.getWithRefresh(i.TRANSACTION(e),t);if(a)return a;let s=await t(),o="completed"===s.status?3e5:3e4;return n.set(i.TRANSACTION(e),s,o),s},async updateStatus(e,t){let a={status:t};"completed"===t&&(a.completed_at=new Date().toISOString());let{data:s,error:o}=await r.OQ.from("transactions").update(a).eq("transaction_id",e).select().single();if(o)throw o;return n.invalidate(i.TRANSACTION(e)),n.invalidatePattern("user_transactions_"),s},async uploadReceipt(e,t){try{let a=new Promise((e,t)=>setTimeout(()=>t(Error("Transaction check timeout")),1e4)),s=r.OQ.from("transactions").select("id, transaction_id").eq("transaction_id",e).single(),{data:o,error:c}=await Promise.race([s,a]);if(c||!o)throw console.error("Transaction check error:",c),Error("Transaction not found. Please create the transaction first.");let l=t.name.split(".").pop(),d=`${e}.${l}`,u=`receipts/${d}`,f=new Promise((e,t)=>setTimeout(()=>t(Error("Upload timeout")),3e4)),m=r.OQ.storage.from("transaction-receipts").upload(u,t,{cacheControl:"3600",upsert:!1}),{data:h,error:p}=await Promise.race([m,f]);if(p)throw console.error("Upload error:",p),Error(`Upload failed: ${p.message}`);let{data:{publicUrl:_}}=r.OQ.storage.from("transaction-receipts").getPublicUrl(u),g=new Promise((e,t)=>setTimeout(()=>t(Error("Database update timeout")),1e4)),y=r.OQ.from("transactions").update({receipt_url:_,receipt_filename:d,updated_at:new Date().toISOString()}).eq("transaction_id",e).select(),{data:w,error:N}=await Promise.race([y,g]);if(N)throw console.error("Database update error:",N),Error(`Database update failed: ${N.message}`);if(!w||0===w.length)throw Error("Failed to update transaction with receipt");let E=w[0];return n.invalidate(i.TRANSACTION(e)),{...E,receipt_url:_}}catch(e){throw console.error("Receipt upload error:",e),e}},async getStats(e="today"){let t=new Date;switch(e){case"today":t.setHours(0,0,0,0);break;case"week":t.setDate(t.getDate()-7);break;case"month":t.setMonth(t.getMonth()-1)}let{data:a}=await r.OQ.from("transactions").select("*").gte("created_at",t.toISOString()),{data:s}=await r.OQ.from("transactions").select("id",{count:"exact"}).in("status",["pending","processing"]),n=a?.reduce((e,t)=>e+Number(t.send_amount),0)||0;return{totalTransactions:a?.length||0,totalVolume:n,pendingTransactions:s?.length||0}}}},79635:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}};