"use strict";(()=>{var e={};e.id=904,e.ids=[904],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},43116:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{POST:()=>l});var o=t(49303),i=t(88716),a=t(60670),n=t(87070),p=t(85662),u=t(41482),c=t.n(u);async function l(e){try{let{email:r,otp:t}=await e.json(),s=(0,p.lx)();if(!r||!t)return n.NextResponse.json({error:"Email and OTP are required"},{status:400});console.log("Verifying Supabase OTP for email:",r,"OTP:",t);let{data:o,error:i}=await s.auth.verifyOtp({email:r,token:t,type:"recovery"});if(i)return console.error("Supabase OTP verification error:",i),n.NextResponse.json({error:"Invalid or expired verification code"},{status:400});if(!o.user)return n.NextResponse.json({error:"Invalid verification code"},{status:400});console.log("Supabase OTP verified successfully for:",r);let a=c().sign({email:r,purpose:"password_reset",exp:Math.floor(Date.now()/1e3)+900},process.env.JWT_SECRET);return n.NextResponse.json({message:"Verification code verified successfully",resetToken:a})}catch(e){return console.error("OTP verification error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/verify-reset-otp/route",pathname:"/api/auth/verify-reset-otp",filename:"route",bundlePath:"app/api/auth/verify-reset-otp/route"},resolvedPagePath:"D:\\Users\\enyoc\\Documents\\Dev\\easner\\app\\api\\auth\\verify-reset-otp\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:v,serverHooks:h}=d,x="/api/auth/verify-reset-otp/route";function E(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}},85662:(e,r,t)=>{t.d(r,{OQ:()=>a,lx:()=>n});var s=t(69498);let o=process.env.NEXT_PUBLIC_SUPABASE_URL||"https://placeholder.supabase.co",i=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"placeholder-key",a=(0,s.eI)(o,i,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"}}),n=()=>{let e=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e){if(!process.env.VERCEL)throw Error("Missing SUPABASE_SERVICE_ROLE_KEY environment variable");return(0,s.eI)(o,i,{auth:{persistSession:!1,autoRefreshToken:!1}})}return(0,s.eI)(o,e,{auth:{persistSession:!1,autoRefreshToken:!1}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,338,482],()=>t(43116));module.exports=s})();