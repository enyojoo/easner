"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/transactions/route";
exports.ids = ["app/api/transactions/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftransactions%2Froute&page=%2Fapi%2Ftransactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftransactions%2Froute.ts&appDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftransactions%2Froute&page=%2Fapi%2Ftransactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftransactions%2Froute.ts&appDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Users_enyoc_Documents_Dev_easner_app_api_transactions_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/transactions/route.ts */ \"(rsc)/./app/api/transactions/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/transactions/route\",\n        pathname: \"/api/transactions\",\n        filename: \"route\",\n        bundlePath: \"app/api/transactions/route\"\n    },\n    resolvedPagePath: \"D:\\\\Users\\\\enyoc\\\\Documents\\\\Dev\\\\easner\\\\app\\\\api\\\\transactions\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Users_enyoc_Documents_Dev_easner_app_api_transactions_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/transactions/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0cmFuc2FjdGlvbnMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnRyYW5zYWN0aW9ucyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnRyYW5zYWN0aW9ucyUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDVXNlcnMlNUNlbnlvYyU1Q0RvY3VtZW50cyU1Q0RldiU1Q2Vhc25lciU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q1VzZXJzJTVDZW55b2MlNUNEb2N1bWVudHMlNUNEZXYlNUNlYXNuZXImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzBCO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZWFzbmVyLz8xNzJlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXFVzZXJzXFxcXGVueW9jXFxcXERvY3VtZW50c1xcXFxEZXZcXFxcZWFzbmVyXFxcXGFwcFxcXFxhcGlcXFxcdHJhbnNhY3Rpb25zXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90cmFuc2FjdGlvbnMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90cmFuc2FjdGlvbnNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3RyYW5zYWN0aW9ucy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXFVzZXJzXFxcXGVueW9jXFxcXERvY3VtZW50c1xcXFxEZXZcXFxcZWFzbmVyXFxcXGFwcFxcXFxhcGlcXFxcdHJhbnNhY3Rpb25zXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS90cmFuc2FjdGlvbnMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftransactions%2Froute&page=%2Fapi%2Ftransactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftransactions%2Froute.ts&appDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/transactions/route.ts":
/*!***************************************!*\
  !*** ./app/api/transactions/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/database */ \"(rsc)/./lib/database.ts\");\n/* harmony import */ var _lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth-utils */ \"(rsc)/./lib/auth-utils.ts\");\n\n\n\nconst GET = (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.withErrorHandling)(async (request)=>{\n    const user = await (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.requireUser)(request);\n    const transactions = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.transactionService.getByUserId(user.id, 20, user.id);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        transactions\n    });\n});\nconst POST = (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.withErrorHandling)(async (request)=>{\n    const user = await (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.requireUser)(request);\n    const { recipientId, sendAmount, sendCurrency, receiveCurrency } = await request.json();\n    // Validate input\n    if (!recipientId || !sendAmount || !sendCurrency || !receiveCurrency) {\n        return (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.createErrorResponse)(\"Missing required fields\", 400);\n    }\n    if (sendAmount <= 0) {\n        return (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.createErrorResponse)(\"Send amount must be greater than 0\", 400);\n    }\n    // Get exchange rate\n    const rateData = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.currencyService.getRate(sendCurrency, receiveCurrency);\n    if (!rateData) {\n        return (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_2__.createErrorResponse)(\"Exchange rate not available\", 400);\n    }\n    const receiveAmount = sendAmount * rateData.rate;\n    let feeAmount = 0;\n    // Calculate fee\n    if (rateData.fee_type === \"fixed\") {\n        feeAmount = rateData.fee_amount;\n    } else if (rateData.fee_type === \"percentage\") {\n        feeAmount = sendAmount * rateData.fee_amount / 100;\n    }\n    const totalAmount = sendAmount + feeAmount;\n    const transaction = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.transactionService.create({\n        userId: user.id,\n        recipientId,\n        sendAmount,\n        sendCurrency,\n        receiveAmount,\n        receiveCurrency,\n        exchangeRate: rateData.rate,\n        feeAmount,\n        feeType: rateData.fee_type,\n        totalAmount\n    }, user.id);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        transaction\n    });\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3RyYW5zYWN0aW9ucy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE0RDtBQUNRO0FBQ2tCO0FBRS9FLE1BQU1NLE1BQU1ELGtFQUFpQkEsQ0FBQyxPQUFPRTtJQUMxQyxNQUFNQyxPQUFPLE1BQU1MLDREQUFXQSxDQUFDSTtJQUMvQixNQUFNRSxlQUFlLE1BQU1SLDZEQUFrQkEsQ0FBQ1MsV0FBVyxDQUFDRixLQUFLRyxFQUFFLEVBQUUsSUFBSUgsS0FBS0csRUFBRTtJQUU5RSxPQUFPWCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO1FBQUVIO0lBQWE7QUFDMUMsR0FBRTtBQUVLLE1BQU1JLE9BQU9SLGtFQUFpQkEsQ0FBQyxPQUFPRTtJQUMzQyxNQUFNQyxPQUFPLE1BQU1MLDREQUFXQSxDQUFDSTtJQUMvQixNQUFNLEVBQUVPLFdBQVcsRUFBRUMsVUFBVSxFQUFFQyxZQUFZLEVBQUVDLGVBQWUsRUFBRSxHQUFHLE1BQU1WLFFBQVFLLElBQUk7SUFFckYsaUJBQWlCO0lBQ2pCLElBQUksQ0FBQ0UsZUFBZSxDQUFDQyxjQUFjLENBQUNDLGdCQUFnQixDQUFDQyxpQkFBaUI7UUFDcEUsT0FBT2Isb0VBQW1CQSxDQUFDLDJCQUEyQjtJQUN4RDtJQUVBLElBQUlXLGNBQWMsR0FBRztRQUNuQixPQUFPWCxvRUFBbUJBLENBQUMsc0NBQXNDO0lBQ25FO0lBRUUsb0JBQW9CO0lBQ3BCLE1BQU1jLFdBQVcsTUFBTWhCLDBEQUFlQSxDQUFDaUIsT0FBTyxDQUFDSCxjQUFjQztJQUM3RCxJQUFJLENBQUNDLFVBQVU7UUFDZixPQUFPZCxvRUFBbUJBLENBQUMsK0JBQStCO0lBQzFEO0lBRUEsTUFBTWdCLGdCQUFnQkwsYUFBYUcsU0FBU0csSUFBSTtJQUNoRCxJQUFJQyxZQUFZO0lBRWhCLGdCQUFnQjtJQUNoQixJQUFJSixTQUFTSyxRQUFRLEtBQUssU0FBUztRQUNqQ0QsWUFBWUosU0FBU00sVUFBVTtJQUNqQyxPQUFPLElBQUlOLFNBQVNLLFFBQVEsS0FBSyxjQUFjO1FBQzdDRCxZQUFZLGFBQWNKLFNBQVNNLFVBQVUsR0FBSTtJQUNuRDtJQUVBLE1BQU1DLGNBQWNWLGFBQWFPO0lBRWpDLE1BQU1JLGNBQWMsTUFBTXpCLDZEQUFrQkEsQ0FBQzBCLE1BQU0sQ0FBQztRQUNsREMsUUFBUXBCLEtBQUtHLEVBQUU7UUFDZkc7UUFDQUM7UUFDQUM7UUFDQUk7UUFDQUg7UUFDQVksY0FBY1gsU0FBU0csSUFBSTtRQUMzQkM7UUFDQVEsU0FBU1osU0FBU0ssUUFBUTtRQUMxQkU7SUFDSixHQUFHakIsS0FBS0csRUFBRTtJQUVSLE9BQU9YLHFEQUFZQSxDQUFDWSxJQUFJLENBQUM7UUFBRWM7SUFBWTtBQUMzQyxHQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZWFzbmVyLy4vYXBwL2FwaS90cmFuc2FjdGlvbnMvcm91dGUudHM/NzcyZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxyXG5pbXBvcnQgeyB0cmFuc2FjdGlvblNlcnZpY2UsIGN1cnJlbmN5U2VydmljZSB9IGZyb20gXCJAL2xpYi9kYXRhYmFzZVwiXHJcbmltcG9ydCB7IHJlcXVpcmVVc2VyLCBjcmVhdGVFcnJvclJlc3BvbnNlLCB3aXRoRXJyb3JIYW5kbGluZyB9IGZyb20gXCJAL2xpYi9hdXRoLXV0aWxzXCJcclxuXHJcbmV4cG9ydCBjb25zdCBHRVQgPSB3aXRoRXJyb3JIYW5kbGluZyhhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgcmVxdWlyZVVzZXIocmVxdWVzdClcclxuICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCB0cmFuc2FjdGlvblNlcnZpY2UuZ2V0QnlVc2VySWQodXNlci5pZCwgMjAsIHVzZXIuaWQpXHJcblxyXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHRyYW5zYWN0aW9ucyB9KVxyXG59KVxyXG5cclxuZXhwb3J0IGNvbnN0IFBPU1QgPSB3aXRoRXJyb3JIYW5kbGluZyhhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgcmVxdWlyZVVzZXIocmVxdWVzdClcclxuICBjb25zdCB7IHJlY2lwaWVudElkLCBzZW5kQW1vdW50LCBzZW5kQ3VycmVuY3ksIHJlY2VpdmVDdXJyZW5jeSB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcclxuXHJcbiAgLy8gVmFsaWRhdGUgaW5wdXRcclxuICBpZiAoIXJlY2lwaWVudElkIHx8ICFzZW5kQW1vdW50IHx8ICFzZW5kQ3VycmVuY3kgfHwgIXJlY2VpdmVDdXJyZW5jeSkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXCJNaXNzaW5nIHJlcXVpcmVkIGZpZWxkc1wiLCA0MDApXHJcbiAgfVxyXG5cclxuICBpZiAoc2VuZEFtb3VudCA8PSAwKSB7XHJcbiAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcIlNlbmQgYW1vdW50IG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIiwgNDAwKVxyXG4gIH1cclxuXHJcbiAgICAvLyBHZXQgZXhjaGFuZ2UgcmF0ZVxyXG4gICAgY29uc3QgcmF0ZURhdGEgPSBhd2FpdCBjdXJyZW5jeVNlcnZpY2UuZ2V0UmF0ZShzZW5kQ3VycmVuY3ksIHJlY2VpdmVDdXJyZW5jeSlcclxuICAgIGlmICghcmF0ZURhdGEpIHtcclxuICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFwiRXhjaGFuZ2UgcmF0ZSBub3QgYXZhaWxhYmxlXCIsIDQwMClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZWNlaXZlQW1vdW50ID0gc2VuZEFtb3VudCAqIHJhdGVEYXRhLnJhdGVcclxuICAgIGxldCBmZWVBbW91bnQgPSAwXHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGZlZVxyXG4gICAgaWYgKHJhdGVEYXRhLmZlZV90eXBlID09PSBcImZpeGVkXCIpIHtcclxuICAgICAgZmVlQW1vdW50ID0gcmF0ZURhdGEuZmVlX2Ftb3VudFxyXG4gICAgfSBlbHNlIGlmIChyYXRlRGF0YS5mZWVfdHlwZSA9PT0gXCJwZXJjZW50YWdlXCIpIHtcclxuICAgICAgZmVlQW1vdW50ID0gKHNlbmRBbW91bnQgKiByYXRlRGF0YS5mZWVfYW1vdW50KSAvIDEwMFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRvdGFsQW1vdW50ID0gc2VuZEFtb3VudCArIGZlZUFtb3VudFxyXG5cclxuICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHJhbnNhY3Rpb25TZXJ2aWNlLmNyZWF0ZSh7XHJcbiAgICAgIHVzZXJJZDogdXNlci5pZCxcclxuICAgICAgcmVjaXBpZW50SWQsXHJcbiAgICAgIHNlbmRBbW91bnQsXHJcbiAgICAgIHNlbmRDdXJyZW5jeSxcclxuICAgICAgcmVjZWl2ZUFtb3VudCxcclxuICAgICAgcmVjZWl2ZUN1cnJlbmN5LFxyXG4gICAgICBleGNoYW5nZVJhdGU6IHJhdGVEYXRhLnJhdGUsXHJcbiAgICAgIGZlZUFtb3VudCxcclxuICAgICAgZmVlVHlwZTogcmF0ZURhdGEuZmVlX3R5cGUsXHJcbiAgICAgIHRvdGFsQW1vdW50LFxyXG4gIH0sIHVzZXIuaWQpXHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdHJhbnNhY3Rpb24gfSlcclxufSlcclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInRyYW5zYWN0aW9uU2VydmljZSIsImN1cnJlbmN5U2VydmljZSIsInJlcXVpcmVVc2VyIiwiY3JlYXRlRXJyb3JSZXNwb25zZSIsIndpdGhFcnJvckhhbmRsaW5nIiwiR0VUIiwicmVxdWVzdCIsInVzZXIiLCJ0cmFuc2FjdGlvbnMiLCJnZXRCeVVzZXJJZCIsImlkIiwianNvbiIsIlBPU1QiLCJyZWNpcGllbnRJZCIsInNlbmRBbW91bnQiLCJzZW5kQ3VycmVuY3kiLCJyZWNlaXZlQ3VycmVuY3kiLCJyYXRlRGF0YSIsImdldFJhdGUiLCJyZWNlaXZlQW1vdW50IiwicmF0ZSIsImZlZUFtb3VudCIsImZlZV90eXBlIiwiZmVlX2Ftb3VudCIsInRvdGFsQW1vdW50IiwidHJhbnNhY3Rpb24iLCJjcmVhdGUiLCJ1c2VySWQiLCJleGNoYW5nZVJhdGUiLCJmZWVUeXBlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/transactions/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth-utils.ts":
/*!***************************!*\
  !*** ./lib/auth-utils.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createErrorResponse: () => (/* binding */ createErrorResponse),\n/* harmony export */   createSuccessResponse: () => (/* binding */ createSuccessResponse),\n/* harmony export */   getAuthenticatedUser: () => (/* binding */ getAuthenticatedUser),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireUser: () => (/* binding */ requireUser),\n/* harmony export */   requireUserAccess: () => (/* binding */ requireUserAccess),\n/* harmony export */   validateUserAccess: () => (/* binding */ validateUserAccess),\n/* harmony export */   withErrorHandling: () => (/* binding */ withErrorHandling)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./lib/supabase.ts\");\n\n/**\r\n * Enhanced authentication with better error handling and validation\r\n */ async function getAuthenticatedUser(request) {\n    try {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        // Try to get token from Authorization header first\n        const authHeader = request.headers.get(\"authorization\");\n        let token = null;\n        if (authHeader && authHeader.startsWith(\"Bearer \")) {\n            token = authHeader.substring(7);\n        }\n        // If no auth header, try to get from cookies\n        if (!token) {\n            token = request.cookies.get(\"sb-access-token\")?.value || null;\n        }\n        if (!token) {\n            console.log(\"No authentication token found\");\n            return null;\n        }\n        // Verify the token with Supabase with timeout\n        const authPromise = supabase.auth.getUser(token);\n        const timeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Auth timeout\")), 10000));\n        const { data: { user }, error } = await Promise.race([\n            authPromise,\n            timeoutPromise\n        ]);\n        if (error) {\n            console.error(\"Auth token verification failed:\", error.message);\n            return null;\n        }\n        if (!user) {\n            console.log(\"No user found in token\");\n            return null;\n        }\n        // Get user profile from database with enhanced validation\n        let userProfile = null;\n        let isAdmin = false;\n        try {\n            // Try regular users table first\n            const { data: regularUser, error: regularUserError } = await supabase.from(\"users\").select(\"*\").eq(\"id\", user.id).single();\n            if (regularUser && !regularUserError) {\n                userProfile = regularUser;\n                isAdmin = false;\n                console.log(\"Regular user authenticated:\", regularUser.email);\n            } else {\n                // Check admin_users table\n                const { data: adminUser, error: adminError } = await supabase.from(\"admin_users\").select(\"*\").eq(\"id\", user.id).single();\n                if (adminUser && !adminError) {\n                    userProfile = adminUser;\n                    isAdmin = true;\n                    console.log(\"Admin user authenticated:\", adminUser.email);\n                }\n            }\n        } catch (dbError) {\n            console.error(\"Database profile lookup failed:\", dbError);\n            return null;\n        }\n        if (!userProfile) {\n            console.log(\"User profile not found in database\");\n            return null;\n        }\n        // Additional validation\n        if (userProfile.status && userProfile.status !== \"active\") {\n            console.log(\"User account is not active:\", userProfile.status);\n            return null;\n        }\n        return {\n            id: user.id,\n            email: user.email,\n            isAdmin,\n            profile: userProfile\n        };\n    } catch (error) {\n        console.error(\"Authentication error:\", error);\n        return null;\n    }\n}\n/**\r\n * Require authentication - throws error if not authenticated\r\n */ async function requireAuth(request) {\n    const user = await getAuthenticatedUser(request);\n    if (!user) {\n        throw new Error(\"Authentication required\");\n    }\n    if (user.profile.status !== \"active\") {\n        throw new Error(\"Account is suspended\");\n    }\n    return user;\n}\n/**\r\n * Require admin authentication - throws error if not admin\r\n */ async function requireAdmin(request) {\n    const user = await requireAuth(request);\n    if (!user.isAdmin) {\n        throw new Error(\"Admin access required\");\n    }\n    return user;\n}\n/**\r\n * Require user authentication (non-admin) - throws error if admin or not authenticated\r\n */ async function requireUser(request) {\n    const user = await requireAuth(request);\n    if (user.isAdmin) {\n        throw new Error(\"Admin users cannot access user APIs\");\n    }\n    return user;\n}\n/**\r\n * Validate user access to specific resource\r\n */ function validateUserAccess(user, resourceUserId) {\n    if (user.isAdmin) {\n        return true // Admins can access all resources\n        ;\n    }\n    return user.id === resourceUserId;\n}\n/**\r\n * Validate user access and throw error if not allowed\r\n */ function requireUserAccess(user, resourceUserId) {\n    if (!validateUserAccess(user, resourceUserId)) {\n        throw new Error(\"Access denied: You can only access your own resources\");\n    }\n}\n/**\r\n * Create standardized API error response\r\n */ function createErrorResponse(message, status = 500) {\n    return Response.json({\n        error: message,\n        timestamp: new Date().toISOString()\n    }, {\n        status\n    });\n}\n/**\r\n * Create standardized API success response\r\n */ function createSuccessResponse(data, status = 200) {\n    return Response.json({\n        success: true,\n        data,\n        timestamp: new Date().toISOString()\n    }, {\n        status\n    });\n}\n/**\r\n * Wrap API handler with error handling\r\n */ function withErrorHandling(handler) {\n    return async (request)=>{\n        try {\n            return await handler(request);\n        } catch (error) {\n            console.error(\"API Error:\", error);\n            if (error instanceof Error) {\n                switch(error.message){\n                    case \"Authentication required\":\n                        return createErrorResponse(\"Authentication required\", 401);\n                    case \"Admin access required\":\n                        return createErrorResponse(\"Admin access required\", 403);\n                    case \"Account is suspended\":\n                        return createErrorResponse(\"Account is suspended\", 403);\n                    default:\n                        return createErrorResponse( true ? error.message : 0, 500);\n                }\n            }\n            return createErrorResponse(\"Internal server error\", 500);\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNuQyxHQUNBO1FBQUViO0lBQU87QUFFYjtBQUVBOztDQUVDLEdBQ00sU0FBU2Msc0JBQXNCaEMsSUFBUyxFQUFFa0IsU0FBaUIsR0FBRztJQUNuRSxPQUFPUyxTQUFTQyxJQUFJLENBQ2xCO1FBQ0VLLFNBQVM7UUFDVGpDO1FBQ0E2QixXQUFXLElBQUlDLE9BQU9DLFdBQVc7SUFDbkMsR0FDQTtRQUFFYjtJQUFPO0FBRWI7QUFFQTs7Q0FFQyxHQUNNLFNBQVNnQixrQkFBa0JDLE9BQW9EO0lBQ3BGLE9BQU8sT0FBT3hEO1FBQ1osSUFBSTtZQUNGLE9BQU8sTUFBTXdELFFBQVF4RDtRQUN2QixFQUFFLE9BQU91QixPQUFPO1lBQ2RiLFFBQVFhLEtBQUssQ0FBQyxjQUFjQTtZQUU1QixJQUFJQSxpQkFBaUJILE9BQU87Z0JBQzFCLE9BQVFHLE1BQU1FLE9BQU87b0JBQ25CLEtBQUs7d0JBQ0gsT0FBT3NCLG9CQUFvQiwyQkFBMkI7b0JBQ3hELEtBQUs7d0JBQ0gsT0FBT0Esb0JBQW9CLHlCQUF5QjtvQkFDdEQsS0FBSzt3QkFDSCxPQUFPQSxvQkFBb0Isd0JBQXdCO29CQUNyRDt3QkFDRSxPQUFPQSxvQkFDTFUsS0FBc0MsR0FDbENsQyxNQUFNRSxPQUFPLEdBQ2IsQ0FBdUIsRUFDM0I7Z0JBRU47WUFDRjtZQUVBLE9BQU9zQixvQkFBb0IseUJBQXlCO1FBQ3REO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Vhc25lci8uL2xpYi9hdXRoLXV0aWxzLnRzPzM4MTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCB9IGZyb20gXCJuZXh0L3NlcnZlclwiXHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gXCIuL3N1cGFiYXNlXCJcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXV0aGVudGljYXRlZFVzZXIge1xyXG4gIGlkOiBzdHJpbmdcclxuICBlbWFpbDogc3RyaW5nXHJcbiAgaXNBZG1pbjogYm9vbGVhblxyXG4gIHByb2ZpbGU6IGFueVxyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgYXV0aGVudGljYXRpb24gd2l0aCBiZXR0ZXIgZXJyb3IgaGFuZGxpbmcgYW5kIHZhbGlkYXRpb25cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRoZW50aWNhdGVkVXNlcihyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8QXV0aGVudGljYXRlZFVzZXIgfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICAgIFxyXG4gICAgLy8gVHJ5IHRvIGdldCB0b2tlbiBmcm9tIEF1dGhvcml6YXRpb24gaGVhZGVyIGZpcnN0XHJcbiAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxdWVzdC5oZWFkZXJzLmdldChcImF1dGhvcml6YXRpb25cIilcclxuICAgIGxldCB0b2tlbjogc3RyaW5nIHwgbnVsbCA9IG51bGxcclxuICAgIFxyXG4gICAgaWYgKGF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zdGFydHNXaXRoKFwiQmVhcmVyIFwiKSkge1xyXG4gICAgICB0b2tlbiA9IGF1dGhIZWFkZXIuc3Vic3RyaW5nKDcpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIG5vIGF1dGggaGVhZGVyLCB0cnkgdG8gZ2V0IGZyb20gY29va2llc1xyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICB0b2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoXCJzYi1hY2Nlc3MtdG9rZW5cIik/LnZhbHVlIHx8IG51bGxcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIk5vIGF1dGhlbnRpY2F0aW9uIHRva2VuIGZvdW5kXCIpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZ5IHRoZSB0b2tlbiB3aXRoIFN1cGFiYXNlIHdpdGggdGltZW91dFxyXG4gICAgY29uc3QgYXV0aFByb21pc2UgPSBzdXBhYmFzZS5hdXRoLmdldFVzZXIodG9rZW4pXHJcbiAgICBjb25zdCB0aW1lb3V0UHJvbWlzZSA9IG5ldyBQcm9taXNlKChfLCByZWplY3QpID0+IFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoXCJBdXRoIHRpbWVvdXRcIikpLCAxMDAwMClcclxuICAgIClcclxuXHJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvciB9ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFthdXRoUHJvbWlzZSwgdGltZW91dFByb21pc2VdKSBhcyBhbnlcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBdXRoIHRva2VuIHZlcmlmaWNhdGlvbiBmYWlsZWQ6XCIsIGVycm9yLm1lc3NhZ2UpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIk5vIHVzZXIgZm91bmQgaW4gdG9rZW5cIilcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdXNlciBwcm9maWxlIGZyb20gZGF0YWJhc2Ugd2l0aCBlbmhhbmNlZCB2YWxpZGF0aW9uXHJcbiAgICBsZXQgdXNlclByb2ZpbGUgPSBudWxsXHJcbiAgICBsZXQgaXNBZG1pbiA9IGZhbHNlXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVHJ5IHJlZ3VsYXIgdXNlcnMgdGFibGUgZmlyc3RcclxuICAgICAgY29uc3QgeyBkYXRhOiByZWd1bGFyVXNlciwgZXJyb3I6IHJlZ3VsYXJVc2VyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJ1c2Vyc1wiKVxyXG4gICAgICAgIC5zZWxlY3QoXCIqXCIpXHJcbiAgICAgICAgLmVxKFwiaWRcIiwgdXNlci5pZClcclxuICAgICAgICAuc2luZ2xlKClcclxuXHJcbiAgICAgIGlmIChyZWd1bGFyVXNlciAmJiAhcmVndWxhclVzZXJFcnJvcikge1xyXG4gICAgICAgIHVzZXJQcm9maWxlID0gcmVndWxhclVzZXJcclxuICAgICAgICBpc0FkbWluID0gZmFsc2VcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlJlZ3VsYXIgdXNlciBhdXRoZW50aWNhdGVkOlwiLCByZWd1bGFyVXNlci5lbWFpbClcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDaGVjayBhZG1pbl91c2VycyB0YWJsZVxyXG4gICAgICAgIGNvbnN0IHsgZGF0YTogYWRtaW5Vc2VyLCBlcnJvcjogYWRtaW5FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKFwiYWRtaW5fdXNlcnNcIilcclxuICAgICAgICAgIC5zZWxlY3QoXCIqXCIpXHJcbiAgICAgICAgICAuZXEoXCJpZFwiLCB1c2VyLmlkKVxyXG4gICAgICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgICAgIGlmIChhZG1pblVzZXIgJiYgIWFkbWluRXJyb3IpIHtcclxuICAgICAgICAgIHVzZXJQcm9maWxlID0gYWRtaW5Vc2VyXHJcbiAgICAgICAgICBpc0FkbWluID0gdHJ1ZVxyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJBZG1pbiB1c2VyIGF1dGhlbnRpY2F0ZWQ6XCIsIGFkbWluVXNlci5lbWFpbClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGRiRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIHByb2ZpbGUgbG9va3VwIGZhaWxlZDpcIiwgZGJFcnJvcilcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXVzZXJQcm9maWxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiVXNlciBwcm9maWxlIG5vdCBmb3VuZCBpbiBkYXRhYmFzZVwiKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZGl0aW9uYWwgdmFsaWRhdGlvblxyXG4gICAgaWYgKHVzZXJQcm9maWxlLnN0YXR1cyAmJiB1c2VyUHJvZmlsZS5zdGF0dXMgIT09IFwiYWN0aXZlXCIpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJVc2VyIGFjY291bnQgaXMgbm90IGFjdGl2ZTpcIiwgdXNlclByb2ZpbGUuc3RhdHVzKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICBlbWFpbDogdXNlci5lbWFpbCEsXHJcbiAgICAgIGlzQWRtaW4sXHJcbiAgICAgIHByb2ZpbGU6IHVzZXJQcm9maWxlLFxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiQXV0aGVudGljYXRpb24gZXJyb3I6XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIG51bGxcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXF1aXJlIGF1dGhlbnRpY2F0aW9uIC0gdGhyb3dzIGVycm9yIGlmIG5vdCBhdXRoZW50aWNhdGVkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUF1dGgocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPEF1dGhlbnRpY2F0ZWRVc2VyPiB7XHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKHJlcXVlc3QpXHJcbiAgXHJcbiAgaWYgKCF1c2VyKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdXRoZW50aWNhdGlvbiByZXF1aXJlZFwiKVxyXG4gIH1cclxuICBcclxuICBpZiAodXNlci5wcm9maWxlLnN0YXR1cyAhPT0gXCJhY3RpdmVcIikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQWNjb3VudCBpcyBzdXNwZW5kZWRcIilcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHVzZXJcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlcXVpcmUgYWRtaW4gYXV0aGVudGljYXRpb24gLSB0aHJvd3MgZXJyb3IgaWYgbm90IGFkbWluXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUFkbWluKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KTogUHJvbWlzZTxBdXRoZW50aWNhdGVkVXNlcj4ge1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCByZXF1aXJlQXV0aChyZXF1ZXN0KVxyXG4gIFxyXG4gIGlmICghdXNlci5pc0FkbWluKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJBZG1pbiBhY2Nlc3MgcmVxdWlyZWRcIilcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHVzZXJcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlcXVpcmUgdXNlciBhdXRoZW50aWNhdGlvbiAobm9uLWFkbWluKSAtIHRocm93cyBlcnJvciBpZiBhZG1pbiBvciBub3QgYXV0aGVudGljYXRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVVc2VyKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KTogUHJvbWlzZTxBdXRoZW50aWNhdGVkVXNlcj4ge1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCByZXF1aXJlQXV0aChyZXF1ZXN0KVxyXG4gIFxyXG4gIGlmICh1c2VyLmlzQWRtaW4pIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkFkbWluIHVzZXJzIGNhbm5vdCBhY2Nlc3MgdXNlciBBUElzXCIpXHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB1c2VyXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB1c2VyIGFjY2VzcyB0byBzcGVjaWZpYyByZXNvdXJjZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVXNlckFjY2Vzcyh1c2VyOiBBdXRoZW50aWNhdGVkVXNlciwgcmVzb3VyY2VVc2VySWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGlmICh1c2VyLmlzQWRtaW4pIHtcclxuICAgIHJldHVybiB0cnVlIC8vIEFkbWlucyBjYW4gYWNjZXNzIGFsbCByZXNvdXJjZXNcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHVzZXIuaWQgPT09IHJlc291cmNlVXNlcklkXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB1c2VyIGFjY2VzcyBhbmQgdGhyb3cgZXJyb3IgaWYgbm90IGFsbG93ZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlVXNlckFjY2Vzcyh1c2VyOiBBdXRoZW50aWNhdGVkVXNlciwgcmVzb3VyY2VVc2VySWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gIGlmICghdmFsaWRhdGVVc2VyQWNjZXNzKHVzZXIsIHJlc291cmNlVXNlcklkKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQWNjZXNzIGRlbmllZDogWW91IGNhbiBvbmx5IGFjY2VzcyB5b3VyIG93biByZXNvdXJjZXNcIilcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgc3RhbmRhcmRpemVkIEFQSSBlcnJvciByZXNwb25zZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yUmVzcG9uc2UobWVzc2FnZTogc3RyaW5nLCBzdGF0dXM6IG51bWJlciA9IDUwMCkge1xyXG4gIHJldHVybiBSZXNwb25zZS5qc29uKFxyXG4gICAgeyBcclxuICAgICAgZXJyb3I6IG1lc3NhZ2UsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfSwgXHJcbiAgICB7IHN0YXR1cyB9XHJcbiAgKVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHN0YW5kYXJkaXplZCBBUEkgc3VjY2VzcyByZXNwb25zZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShkYXRhOiBhbnksIHN0YXR1czogbnVtYmVyID0gMjAwKSB7XHJcbiAgcmV0dXJuIFJlc3BvbnNlLmpzb24oXHJcbiAgICB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfSxcclxuICAgIHsgc3RhdHVzIH1cclxuICApXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBXcmFwIEFQSSBoYW5kbGVyIHdpdGggZXJyb3IgaGFuZGxpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoRXJyb3JIYW5kbGluZyhoYW5kbGVyOiAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IFByb21pc2U8UmVzcG9uc2U+KSB7XHJcbiAgcmV0dXJuIGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8UmVzcG9uc2U+ID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVyKHJlcXVlc3QpXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiQVBJIEVycm9yOlwiLCBlcnJvcilcclxuICAgICAgXHJcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgICAgc3dpdGNoIChlcnJvci5tZXNzYWdlKSB7XHJcbiAgICAgICAgICBjYXNlIFwiQXV0aGVudGljYXRpb24gcmVxdWlyZWRcIjpcclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXCJBdXRoZW50aWNhdGlvbiByZXF1aXJlZFwiLCA0MDEpXHJcbiAgICAgICAgICBjYXNlIFwiQWRtaW4gYWNjZXNzIHJlcXVpcmVkXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFwiQWRtaW4gYWNjZXNzIHJlcXVpcmVkXCIsIDQwMylcclxuICAgICAgICAgIGNhc2UgXCJBY2NvdW50IGlzIHN1c3BlbmRlZFwiOlxyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcIkFjY291bnQgaXMgc3VzcGVuZGVkXCIsIDQwMylcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFxyXG4gICAgICAgICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgXHJcbiAgICAgICAgICAgICAgICA/IGVycm9yLm1lc3NhZ2UgXHJcbiAgICAgICAgICAgICAgICA6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsXHJcbiAgICAgICAgICAgICAgNTAwXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsIDUwMClcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNyZWF0ZVNlcnZlckNsaWVudCIsImdldEF1dGhlbnRpY2F0ZWRVc2VyIiwicmVxdWVzdCIsInN1cGFiYXNlIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJ0b2tlbiIsInN0YXJ0c1dpdGgiLCJzdWJzdHJpbmciLCJjb29raWVzIiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwiYXV0aFByb21pc2UiLCJhdXRoIiwiZ2V0VXNlciIsInRpbWVvdXRQcm9taXNlIiwiUHJvbWlzZSIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiRXJyb3IiLCJkYXRhIiwidXNlciIsImVycm9yIiwicmFjZSIsIm1lc3NhZ2UiLCJ1c2VyUHJvZmlsZSIsImlzQWRtaW4iLCJyZWd1bGFyVXNlciIsInJlZ3VsYXJVc2VyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImVtYWlsIiwiYWRtaW5Vc2VyIiwiYWRtaW5FcnJvciIsImRiRXJyb3IiLCJzdGF0dXMiLCJwcm9maWxlIiwicmVxdWlyZUF1dGgiLCJyZXF1aXJlQWRtaW4iLCJyZXF1aXJlVXNlciIsInZhbGlkYXRlVXNlckFjY2VzcyIsInJlc291cmNlVXNlcklkIiwicmVxdWlyZVVzZXJBY2Nlc3MiLCJjcmVhdGVFcnJvclJlc3BvbnNlIiwiUmVzcG9uc2UiLCJqc29uIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiY3JlYXRlU3VjY2Vzc1Jlc3BvbnNlIiwic3VjY2VzcyIsIndpdGhFcnJvckhhbmRsaW5nIiwiaGFuZGxlciIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth-utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/cache.ts":
/*!**********************!*\
  !*** ./lib/cache.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CACHE_KEYS: () => (/* binding */ CACHE_KEYS),\n/* harmony export */   dataCache: () => (/* binding */ dataCache)\n/* harmony export */ });\nclass DataCache {\n    set(key, data, ttl = this.DEFAULT_TTL) {\n        this.cache.set(key, {\n            data,\n            timestamp: Date.now(),\n            ttl,\n            isStale: false\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) {\n            return null;\n        }\n        const now = Date.now();\n        const age = now - item.timestamp;\n        // If data is expired, remove it\n        if (age > this.STALE_WHILE_REVALIDATE_TTL) {\n            this.cache.delete(key);\n            return null;\n        }\n        // Mark as stale if past TTL but still within stale-while-revalidate window\n        if (age > item.ttl) {\n            item.isStale = true;\n        }\n        return item.data;\n    }\n    isStale(key) {\n        const item = this.cache.get(key);\n        if (!item) return true;\n        const now = Date.now();\n        const age = now - item.timestamp;\n        return age > item.ttl;\n    }\n    // Get data and trigger background refresh if stale\n    getWithRefresh(key, refreshFn) {\n        const data = this.get(key);\n        if (data && this.isStale(key) && !this.refreshPromises.has(key)) {\n            // Background refresh for stale data\n            this.refreshPromises.set(key, refreshFn().then((freshData)=>{\n                this.set(key, freshData);\n                return freshData;\n            }).catch((error)=>{\n                console.error(`Background refresh failed for ${key}:`, error);\n                return data // Return stale data on error\n                ;\n            }).finally(()=>{\n                this.refreshPromises.delete(key);\n            }));\n        }\n        return data;\n    }\n    invalidate(key) {\n        this.cache.delete(key);\n        this.refreshPromises.delete(key);\n    }\n    invalidatePattern(pattern) {\n        const regex = new RegExp(pattern);\n        for (const key of this.cache.keys()){\n            if (regex.test(key)) {\n                this.cache.delete(key);\n                this.refreshPromises.delete(key);\n            }\n        }\n    }\n    clear() {\n        this.cache.clear();\n        this.refreshPromises.clear();\n    }\n    // Force refresh data\n    async forceRefresh(key, refreshFn) {\n        this.invalidate(key);\n        const data = await refreshFn();\n        this.set(key, data);\n        return data;\n    }\n    // Get cache stats for debugging\n    getStats() {\n        return {\n            size: this.cache.size,\n            refreshing: this.refreshPromises.size,\n            keys: Array.from(this.cache.keys())\n        };\n    }\n    constructor(){\n        this.cache = new Map();\n        this.DEFAULT_TTL = 2 * 60 * 1000 // 2 minutes\n        ;\n        this.STALE_WHILE_REVALIDATE_TTL = 5 * 60 * 1000 // 5 minutes\n        ;\n        this.refreshPromises = new Map();\n    }\n}\nconst dataCache = new DataCache();\n// Cache keys with optimized TTLs\nconst CACHE_KEYS = {\n    CURRENCIES: \"currencies\",\n    EXCHANGE_RATES: \"exchange_rates\",\n    USER_RECIPIENTS: (userId)=>`user_recipients_${userId}`,\n    PAYMENT_METHODS: \"payment_methods\",\n    USER_TRANSACTIONS: (userId)=>`user_transactions_${userId}`,\n    TRANSACTION: (transactionId)=>`transaction_${transactionId}`,\n    USER_PROFILE: (userId)=>`user_profile_${userId}`\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUVlLFNBQTJCLEVBQWM7UUFDMUUsSUFBSSxDQUFDUyxVQUFVLENBQUN4QjtRQUNoQixNQUFNQyxPQUFPLE1BQU1jO1FBQ25CLElBQUksQ0FBQ2hCLEdBQUcsQ0FBQ0MsS0FBS0M7UUFDZCxPQUFPQTtJQUNUO0lBRUEsZ0NBQWdDO0lBQ2hDZ0MsV0FBVztRQUNULE9BQU87WUFDTEMsTUFBTSxJQUFJLENBQUM5QixLQUFLLENBQUM4QixJQUFJO1lBQ3JCQyxZQUFZLElBQUksQ0FBQ25CLGVBQWUsQ0FBQ2tCLElBQUk7WUFDckNMLE1BQU1PLE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUNqQyxLQUFLLENBQUN5QixJQUFJO1FBQ2xDO0lBQ0Y7O2FBNUdRekIsUUFBUSxJQUFJa0M7YUFDSG5DLGNBQWMsSUFBSSxLQUFLLEtBQUssWUFBWTs7YUFDeENTLDZCQUE2QixJQUFJLEtBQUssS0FBSyxZQUFZOzthQUNoRUksa0JBQWtCLElBQUlzQjs7QUEwR2hDO0FBRU8sTUFBTUMsWUFBWSxJQUFJekMsWUFBVztBQUV4QyxpQ0FBaUM7QUFDMUIsTUFBTTBDLGFBQWE7SUFDeEJDLFlBQVk7SUFDWkMsZ0JBQWdCO0lBQ2hCQyxpQkFBaUIsQ0FBQ0MsU0FBbUIsQ0FBQyxnQkFBZ0IsRUFBRUEsT0FBTyxDQUFDO0lBQ2hFQyxpQkFBaUI7SUFDakJDLG1CQUFtQixDQUFDRixTQUFtQixDQUFDLGtCQUFrQixFQUFFQSxPQUFPLENBQUM7SUFDcEVHLGFBQWEsQ0FBQ0MsZ0JBQTBCLENBQUMsWUFBWSxFQUFFQSxjQUFjLENBQUM7SUFDdEVDLGNBQWMsQ0FBQ0wsU0FBbUIsQ0FBQyxhQUFhLEVBQUVBLE9BQU8sQ0FBQztBQUM1RCxFQUFVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZWFzbmVyLy4vbGliL2NhY2hlLnRzPzdjYmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIENhY2hlSXRlbTxUPiB7XG4gIGRhdGE6IFRcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgdHRsOiBudW1iZXJcbiAgaXNTdGFsZT86IGJvb2xlYW5cbn1cblxuY2xhc3MgRGF0YUNhY2hlIHtcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBDYWNoZUl0ZW08YW55Pj4oKVxuICBwcml2YXRlIHJlYWRvbmx5IERFRkFVTFRfVFRMID0gMiAqIDYwICogMTAwMCAvLyAyIG1pbnV0ZXNcbiAgcHJpdmF0ZSByZWFkb25seSBTVEFMRV9XSElMRV9SRVZBTElEQVRFX1RUTCA9IDUgKiA2MCAqIDEwMDAgLy8gNSBtaW51dGVzXG4gIHByaXZhdGUgcmVmcmVzaFByb21pc2VzID0gbmV3IE1hcDxzdHJpbmcsIFByb21pc2U8YW55Pj4oKVxuXG4gIHNldDxUPihrZXk6IHN0cmluZywgZGF0YTogVCwgdHRsOiBudW1iZXIgPSB0aGlzLkRFRkFVTFRfVFRMKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XG4gICAgICBkYXRhLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgdHRsLFxuICAgICAgaXNTdGFsZTogZmFsc2UsXG4gICAgfSlcbiAgfVxuXG4gIGdldDxUPihrZXk6IHN0cmluZyk6IFQgfCBudWxsIHtcbiAgICBjb25zdCBpdGVtID0gdGhpcy5jYWNoZS5nZXQoa2V5KVxuXG4gICAgaWYgKCFpdGVtKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBjb25zdCBhZ2UgPSBub3cgLSBpdGVtLnRpbWVzdGFtcFxuXG4gICAgLy8gSWYgZGF0YSBpcyBleHBpcmVkLCByZW1vdmUgaXRcbiAgICBpZiAoYWdlID4gdGhpcy5TVEFMRV9XSElMRV9SRVZBTElEQVRFX1RUTCkge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICAvLyBNYXJrIGFzIHN0YWxlIGlmIHBhc3QgVFRMIGJ1dCBzdGlsbCB3aXRoaW4gc3RhbGUtd2hpbGUtcmV2YWxpZGF0ZSB3aW5kb3dcbiAgICBpZiAoYWdlID4gaXRlbS50dGwpIHtcbiAgICAgIGl0ZW0uaXNTdGFsZSA9IHRydWVcbiAgICB9XG5cbiAgICByZXR1cm4gaXRlbS5kYXRhIGFzIFRcbiAgfVxuXG4gIGlzU3RhbGUoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBpdGVtID0gdGhpcy5jYWNoZS5nZXQoa2V5KVxuICAgIGlmICghaXRlbSkgcmV0dXJuIHRydWVcblxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBjb25zdCBhZ2UgPSBub3cgLSBpdGVtLnRpbWVzdGFtcFxuICAgIHJldHVybiBhZ2UgPiBpdGVtLnR0bFxuICB9XG5cbiAgLy8gR2V0IGRhdGEgYW5kIHRyaWdnZXIgYmFja2dyb3VuZCByZWZyZXNoIGlmIHN0YWxlXG4gIGdldFdpdGhSZWZyZXNoPFQ+KGtleTogc3RyaW5nLCByZWZyZXNoRm46ICgpID0+IFByb21pc2U8VD4pOiBUIHwgbnVsbCB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0PFQ+KGtleSlcblxuICAgIGlmIChkYXRhICYmIHRoaXMuaXNTdGFsZShrZXkpICYmICF0aGlzLnJlZnJlc2hQcm9taXNlcy5oYXMoa2V5KSkge1xuICAgICAgLy8gQmFja2dyb3VuZCByZWZyZXNoIGZvciBzdGFsZSBkYXRhXG4gICAgICB0aGlzLnJlZnJlc2hQcm9taXNlcy5zZXQoXG4gICAgICAgIGtleSxcbiAgICAgICAgcmVmcmVzaEZuKClcbiAgICAgICAgICAudGhlbigoZnJlc2hEYXRhKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldChrZXksIGZyZXNoRGF0YSlcbiAgICAgICAgICAgIHJldHVybiBmcmVzaERhdGFcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEJhY2tncm91bmQgcmVmcmVzaCBmYWlsZWQgZm9yICR7a2V5fTpgLCBlcnJvcilcbiAgICAgICAgICAgIHJldHVybiBkYXRhIC8vIFJldHVybiBzdGFsZSBkYXRhIG9uIGVycm9yXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQcm9taXNlcy5kZWxldGUoa2V5KVxuICAgICAgICAgIH0pLFxuICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBpbnZhbGlkYXRlKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KVxuICAgIHRoaXMucmVmcmVzaFByb21pc2VzLmRlbGV0ZShrZXkpXG4gIH1cblxuICBpbnZhbGlkYXRlUGF0dGVybihwYXR0ZXJuOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybilcbiAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLmNhY2hlLmtleXMoKSkge1xuICAgICAgaWYgKHJlZ2V4LnRlc3Qoa2V5KSkge1xuICAgICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpXG4gICAgICAgIHRoaXMucmVmcmVzaFByb21pc2VzLmRlbGV0ZShrZXkpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5jbGVhcigpXG4gICAgdGhpcy5yZWZyZXNoUHJvbWlzZXMuY2xlYXIoKVxuICB9XG5cbiAgLy8gRm9yY2UgcmVmcmVzaCBkYXRhXG4gIGFzeW5jIGZvcmNlUmVmcmVzaDxUPihrZXk6IHN0cmluZywgcmVmcmVzaEZuOiAoKSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gICAgdGhpcy5pbnZhbGlkYXRlKGtleSlcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVmcmVzaEZuKClcbiAgICB0aGlzLnNldChrZXksIGRhdGEpXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vIEdldCBjYWNoZSBzdGF0cyBmb3IgZGVidWdnaW5nXG4gIGdldFN0YXRzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzaXplOiB0aGlzLmNhY2hlLnNpemUsXG4gICAgICByZWZyZXNoaW5nOiB0aGlzLnJlZnJlc2hQcm9taXNlcy5zaXplLFxuICAgICAga2V5czogQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmtleXMoKSksXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBkYXRhQ2FjaGUgPSBuZXcgRGF0YUNhY2hlKClcblxuLy8gQ2FjaGUga2V5cyB3aXRoIG9wdGltaXplZCBUVExzXG5leHBvcnQgY29uc3QgQ0FDSEVfS0VZUyA9IHtcbiAgQ1VSUkVOQ0lFUzogXCJjdXJyZW5jaWVzXCIsXG4gIEVYQ0hBTkdFX1JBVEVTOiBcImV4Y2hhbmdlX3JhdGVzXCIsXG4gIFVTRVJfUkVDSVBJRU5UUzogKHVzZXJJZDogc3RyaW5nKSA9PiBgdXNlcl9yZWNpcGllbnRzXyR7dXNlcklkfWAsXG4gIFBBWU1FTlRfTUVUSE9EUzogXCJwYXltZW50X21ldGhvZHNcIixcbiAgVVNFUl9UUkFOU0FDVElPTlM6ICh1c2VySWQ6IHN0cmluZykgPT4gYHVzZXJfdHJhbnNhY3Rpb25zXyR7dXNlcklkfWAsXG4gIFRSQU5TQUNUSU9OOiAodHJhbnNhY3Rpb25JZDogc3RyaW5nKSA9PiBgdHJhbnNhY3Rpb25fJHt0cmFuc2FjdGlvbklkfWAsXG4gIFVTRVJfUFJPRklMRTogKHVzZXJJZDogc3RyaW5nKSA9PiBgdXNlcl9wcm9maWxlXyR7dXNlcklkfWAsXG59IGFzIGNvbnN0XG4iXSwibmFtZXMiOlsiRGF0YUNhY2hlIiwic2V0Iiwia2V5IiwiZGF0YSIsInR0bCIsIkRFRkFVTFRfVFRMIiwiY2FjaGUiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiaXNTdGFsZSIsImdldCIsIml0ZW0iLCJhZ2UiLCJTVEFMRV9XSElMRV9SRVZBTElEQVRFX1RUTCIsImRlbGV0ZSIsImdldFdpdGhSZWZyZXNoIiwicmVmcmVzaEZuIiwicmVmcmVzaFByb21pc2VzIiwiaGFzIiwidGhlbiIsImZyZXNoRGF0YSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluYWxseSIsImludmFsaWRhdGUiLCJpbnZhbGlkYXRlUGF0dGVybiIsInBhdHRlcm4iLCJyZWdleCIsIlJlZ0V4cCIsImtleXMiLCJ0ZXN0IiwiY2xlYXIiLCJmb3JjZVJlZnJlc2giLCJnZXRTdGF0cyIsInNpemUiLCJyZWZyZXNoaW5nIiwiQXJyYXkiLCJmcm9tIiwiTWFwIiwiZGF0YUNhY2hlIiwiQ0FDSEVfS0VZUyIsIkNVUlJFTkNJRVMiLCJFWENIQU5HRV9SQVRFUyIsIlVTRVJfUkVDSVBJRU5UUyIsInVzZXJJZCIsIlBBWU1FTlRfTUVUSE9EUyIsIlVTRVJfVFJBTlNBQ1RJT05TIiwiVFJBTlNBQ1RJT04iLCJ0cmFuc2FjdGlvbklkIiwiVVNFUl9QUk9GSUxFIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/cache.ts\n");

/***/ }),

/***/ "(rsc)/./lib/database.ts":
/*!*************************!*\
  !*** ./lib/database.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminService: () => (/* binding */ adminService),\n/* harmony export */   currencyService: () => (/* binding */ currencyService),\n/* harmony export */   paymentMethodService: () => (/* binding */ paymentMethodService),\n/* harmony export */   recipientService: () => (/* binding */ recipientService),\n/* harmony export */   settingsService: () => (/* binding */ settingsService),\n/* harmony export */   transactionService: () => (/* binding */ transactionService),\n/* harmony export */   userService: () => (/* binding */ userService)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./lib/supabase.ts\");\n/* harmony import */ var _cache__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cache */ \"(rsc)/./lib/cache.ts\");\n\n\n// User operations\nconst userService = {\n    async findByEmail (email) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").select(\"*\").eq(\"email\", email).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async updateProfile (userId, updates) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").update({\n            first_name: updates.firstName,\n            last_name: updates.lastName,\n            phone: updates.phone,\n            base_currency: updates.baseCurrency,\n            updated_at: new Date().toISOString()\n        }).eq(\"id\", userId).select().single();\n        if (error) throw error;\n        // Invalidate user profile cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_PROFILE(userId));\n        return data;\n    },\n    async getStats () {\n        const { data: totalUsers } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").select(\"id\", {\n            count: \"exact\"\n        });\n        const { data: activeUsers } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").select(\"id\", {\n            count: \"exact\"\n        }).eq(\"status\", \"active\");\n        const { data: verifiedUsers } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").select(\"id\", {\n            count: \"exact\"\n        }).eq(\"verification_status\", \"verified\");\n        return {\n            total: totalUsers?.length || 0,\n            active: activeUsers?.length || 0,\n            verified: verifiedUsers?.length || 0\n        };\n    }\n};\n// Currency operations with stale-while-revalidate caching\nconst currencyService = {\n    async getAll () {\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"currencies\").select(\"id, code, name, symbol, flag_svg, status, created_at, updated_at\").eq(\"status\", \"active\").order(\"code\");\n            if (error) throw error;\n            return data?.map((currency)=>({\n                    ...currency,\n                    flag: currency.flag_svg\n                })) || [];\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.CURRENCIES, refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const currencies = await refreshFn();\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.CURRENCIES, currencies, 5 * 60 * 1000) // 5 minutes\n        ;\n        return currencies;\n    },\n    async getExchangeRates () {\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"exchange_rates\").select(`\r\n          *,\r\n          from_currency_info:currencies!exchange_rates_from_currency_fkey(id, code, name, symbol, flag_svg),\r\n          to_currency_info:currencies!exchange_rates_to_currency_fkey(id, code, name, symbol, flag_svg)\r\n        `).eq(\"status\", \"active\");\n            if (error) throw error;\n            return data?.map((rate)=>({\n                    ...rate,\n                    from_currency_info: rate.from_currency_info ? {\n                        ...rate.from_currency_info,\n                        flag: rate.from_currency_info.flag_svg\n                    } : undefined,\n                    to_currency_info: rate.to_currency_info ? {\n                        ...rate.to_currency_info,\n                        flag: rate.to_currency_info.flag_svg\n                    } : undefined\n                })) || [];\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.EXCHANGE_RATES, refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const rates = await refreshFn();\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.EXCHANGE_RATES, rates, 2 * 60 * 1000) // 2 minutes\n        ;\n        return rates;\n    },\n    async getRate (fromCurrency, toCurrency) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"exchange_rates\").select(\"*\").eq(\"from_currency\", fromCurrency).eq(\"to_currency\", toCurrency).eq(\"status\", \"active\").single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async updateRate (fromCurrency, toCurrency, rate, feeType = \"free\", feeAmount = 0) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"exchange_rates\").upsert({\n            from_currency: fromCurrency,\n            to_currency: toCurrency,\n            rate,\n            fee_type: feeType,\n            fee_amount: feeAmount,\n            status: \"active\",\n            updated_at: new Date().toISOString()\n        }).select().single();\n        if (error) throw error;\n        // Force refresh exchange rates cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.EXCHANGE_RATES);\n        return data;\n    }\n};\n// Recipient operations with improved caching\nconst recipientService = {\n    async create (userId, recipientData) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"recipients\").insert({\n            user_id: userId,\n            full_name: recipientData.fullName,\n            account_number: recipientData.accountNumber,\n            bank_name: recipientData.bankName,\n            phone_number: recipientData.phoneNumber,\n            currency: recipientData.currency\n        }).select().single();\n        if (error) throw error;\n        // Force refresh user recipients cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_RECIPIENTS(userId));\n        return data;\n    },\n    async getByUserId (userId, requestingUserId) {\n        // Validate user access if requestingUserId is provided\n        if (requestingUserId && requestingUserId !== userId) {\n            throw new Error(\"Access denied: You can only view your own recipients\");\n        }\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"recipients\").select(\"*\").eq(\"user_id\", userId).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) throw error;\n            return data || [];\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_RECIPIENTS(userId), refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const recipients = await refreshFn();\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_RECIPIENTS(userId), recipients, 2 * 60 * 1000) // 2 minutes\n        ;\n        return recipients;\n    },\n    async update (recipientId, updates) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"recipients\").update({\n            full_name: updates.fullName,\n            account_number: updates.accountNumber,\n            bank_name: updates.bankName,\n            phone_number: updates.phoneNumber\n        }).eq(\"id\", recipientId).select().single();\n        if (error) throw error;\n        // Invalidate related caches\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidatePattern(\"user_recipients_\");\n        return data;\n    },\n    async delete (recipientId) {\n        const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"recipients\").delete().eq(\"id\", recipientId);\n        if (error) throw error;\n        // Invalidate related caches\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidatePattern(\"user_recipients_\");\n    }\n};\n// Transaction operations with enhanced access control\nconst transactionService = {\n    async create (transactionData, requestingUserId) {\n        // Validate user access if requestingUserId is provided\n        if (requestingUserId && requestingUserId !== transactionData.userId) {\n            throw new Error(\"Access denied: You can only create transactions for yourself\");\n        }\n        const transactionId = `ETID${Date.now()}`;\n        try {\n            // Add timeout to prevent hanging\n            const timeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Transaction creation timeout\")), 15000));\n            const createPromise = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").insert({\n                transaction_id: transactionId,\n                user_id: transactionData.userId,\n                recipient_id: transactionData.recipientId,\n                send_amount: transactionData.sendAmount,\n                send_currency: transactionData.sendCurrency,\n                receive_amount: transactionData.receiveAmount,\n                receive_currency: transactionData.receiveCurrency,\n                exchange_rate: transactionData.exchangeRate,\n                fee_amount: transactionData.feeAmount,\n                fee_type: transactionData.feeType,\n                total_amount: transactionData.totalAmount,\n                reference: transactionData.reference\n            }).select().single();\n            const { data, error } = await Promise.race([\n                createPromise,\n                timeoutPromise\n            ]);\n            if (error) throw error;\n            // Force refresh user transactions cache\n            _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_TRANSACTIONS(transactionData.userId));\n            return data;\n        } catch (error) {\n            console.error(\"Transaction creation error:\", error);\n            throw new Error(\"Failed to create transaction. Please check your connection and try again.\");\n        }\n    },\n    async getByUserId (userId, limit = 20, requestingUserId) {\n        // Validate user access if requestingUserId is provided\n        if (requestingUserId && requestingUserId !== userId) {\n            throw new Error(\"Access denied: You can only view your own transactions\");\n        }\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").select(`\r\n          *,\r\n          recipient:recipients(*)\r\n        `).eq(\"user_id\", userId).order(\"created_at\", {\n                ascending: false\n            }).limit(limit);\n            if (error) throw error;\n            return data || [];\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_TRANSACTIONS(userId), refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const transactions = await refreshFn();\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.USER_TRANSACTIONS(userId), transactions, 1 * 60 * 1000) // 1 minute\n        ;\n        return transactions;\n    },\n    async getById (transactionId) {\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").select(`\r\n          *,\r\n          recipient:recipients(*),\r\n          user:users(first_name, last_name, email)\r\n        `).eq(\"transaction_id\", transactionId).single();\n            if (error) throw error;\n            return data;\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.TRANSACTION(transactionId), refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const transaction = await refreshFn();\n        const ttl = transaction.status === \"completed\" ? 5 * 60 * 1000 : 30 * 1000 // 5 min for completed, 30s for active\n        ;\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.TRANSACTION(transactionId), transaction, ttl);\n        return transaction;\n    },\n    async updateStatus (transactionId, status) {\n        const updates = {\n            status\n        };\n        if (status === \"completed\") {\n            updates.completed_at = new Date().toISOString();\n        }\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").update(updates).eq(\"transaction_id\", transactionId).select().single();\n        if (error) throw error;\n        // Force refresh transaction cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.TRANSACTION(transactionId));\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidatePattern(\"user_transactions_\");\n        return data;\n    },\n    async uploadReceipt (transactionId, file) {\n        try {\n            // First check if transaction exists with timeout\n            const timeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Transaction check timeout\")), 10000));\n            const checkPromise = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").select(\"id, transaction_id\").eq(\"transaction_id\", transactionId).single();\n            const { data: existingTransaction, error: checkError } = await Promise.race([\n                checkPromise,\n                timeoutPromise\n            ]);\n            if (checkError || !existingTransaction) {\n                console.error(\"Transaction check error:\", checkError);\n                throw new Error(\"Transaction not found. Please create the transaction first.\");\n            }\n            // Generate unique filename\n            const fileExt = file.name.split(\".\").pop();\n            const fileName = `${transactionId}.${fileExt}`;\n            const filePath = `receipts/${fileName}`;\n            // Upload file to Supabase Storage with timeout\n            const uploadTimeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Upload timeout\")), 30000));\n            const uploadPromise = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.storage.from(\"transaction-receipts\").upload(filePath, file, {\n                cacheControl: \"3600\",\n                upsert: false\n            });\n            const { data: uploadData, error: uploadError } = await Promise.race([\n                uploadPromise,\n                uploadTimeoutPromise\n            ]);\n            if (uploadError) {\n                console.error(\"Upload error:\", uploadError);\n                throw new Error(`Upload failed: ${uploadError.message}`);\n            }\n            // Get public URL\n            const { data: { publicUrl } } = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.storage.from(\"transaction-receipts\").getPublicUrl(filePath);\n            // Update transaction with receipt URL\n            const updateTimeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Database update timeout\")), 10000));\n            const updatePromise = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").update({\n                receipt_url: publicUrl,\n                receipt_filename: fileName,\n                updated_at: new Date().toISOString()\n            }).eq(\"transaction_id\", transactionId).select();\n            const { data, error } = await Promise.race([\n                updatePromise,\n                updateTimeoutPromise\n            ]);\n            if (error) {\n                console.error(\"Database update error:\", error);\n                throw new Error(`Database update failed: ${error.message}`);\n            }\n            if (!data || data.length === 0) {\n                throw new Error(\"Failed to update transaction with receipt\");\n            }\n            const updatedTransaction = data[0];\n            // Force refresh transaction cache\n            _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.TRANSACTION(transactionId));\n            return {\n                ...updatedTransaction,\n                receipt_url: publicUrl\n            };\n        } catch (error) {\n            console.error(\"Receipt upload error:\", error);\n            throw error;\n        }\n    },\n    async getStats (timeRange = \"today\") {\n        const dateFilter = new Date();\n        switch(timeRange){\n            case \"today\":\n                dateFilter.setHours(0, 0, 0, 0);\n                break;\n            case \"week\":\n                dateFilter.setDate(dateFilter.getDate() - 7);\n                break;\n            case \"month\":\n                dateFilter.setMonth(dateFilter.getMonth() - 1);\n                break;\n        }\n        const { data: transactions } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").select(\"*\").gte(\"created_at\", dateFilter.toISOString());\n        const { data: pendingTransactions } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"transactions\").select(\"id\", {\n            count: \"exact\"\n        }).in(\"status\", [\n            \"pending\",\n            \"processing\"\n        ]);\n        const totalVolume = transactions?.reduce((sum, t)=>sum + Number(t.send_amount), 0) || 0;\n        return {\n            totalTransactions: transactions?.length || 0,\n            totalVolume,\n            pendingTransactions: pendingTransactions?.length || 0\n        };\n    }\n};\n// Payment Methods operations with improved caching\nconst paymentMethodService = {\n    async getAll () {\n        const refreshFn = async ()=>{\n            const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"payment_methods\").select(\"*\").order(\"currency\", {\n                ascending: true\n            }).order(\"is_default\", {\n                ascending: false\n            });\n            if (error) throw error;\n            return data || [];\n        };\n        // Try cache first with background refresh\n        const cached = _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.getWithRefresh(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS, refreshFn);\n        if (cached) {\n            return cached;\n        }\n        // If no cache, fetch fresh data\n        const methods = await refreshFn();\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.set(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS, methods, 5 * 60 * 1000) // 5 minutes\n        ;\n        return methods;\n    },\n    async getByCurrency (currency) {\n        const allMethods = await this.getAll();\n        return allMethods.filter((pm)=>pm.currency === currency && pm.status === \"active\");\n    },\n    async create (paymentMethodData) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        // If setting as default, unset other defaults for the same currency\n        if (paymentMethodData.isDefault) {\n            await serverClient.from(\"payment_methods\").update({\n                is_default: false\n            }).eq(\"currency\", paymentMethodData.currency);\n        }\n        const { data, error } = await serverClient.from(\"payment_methods\").insert({\n            currency: paymentMethodData.currency,\n            type: paymentMethodData.type,\n            name: paymentMethodData.name,\n            account_name: paymentMethodData.accountName,\n            account_number: paymentMethodData.accountNumber,\n            bank_name: paymentMethodData.bankName,\n            qr_code_data: paymentMethodData.qrCodeData,\n            instructions: paymentMethodData.instructions,\n            is_default: paymentMethodData.isDefault || false,\n            status: \"active\"\n        }).select().single();\n        if (error) throw error;\n        // Force refresh payment methods cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS);\n        return data;\n    },\n    async update (id, updates) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        // If setting as default, unset other defaults for the same currency\n        if (updates.isDefault && updates.currency) {\n            await serverClient.from(\"payment_methods\").update({\n                is_default: false\n            }).eq(\"currency\", updates.currency).neq(\"id\", id);\n        }\n        const { data, error } = await serverClient.from(\"payment_methods\").update({\n            currency: updates.currency,\n            type: updates.type,\n            name: updates.name,\n            account_name: updates.accountName,\n            account_number: updates.accountNumber,\n            bank_name: updates.bankName,\n            qr_code_data: updates.qrCodeData,\n            instructions: updates.instructions,\n            is_default: updates.isDefault\n        }).eq(\"id\", id).select().single();\n        if (error) throw error;\n        // Force refresh payment methods cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS);\n        return data;\n    },\n    async updateStatus (id, status) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        const { data, error } = await serverClient.from(\"payment_methods\").update({\n            status\n        }).eq(\"id\", id).select().single();\n        if (error) throw error;\n        // Force refresh payment methods cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS);\n        return data;\n    },\n    async setDefault (id, currency) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        // Unset other defaults for the same currency\n        await serverClient.from(\"payment_methods\").update({\n            is_default: false\n        }).eq(\"currency\", currency);\n        // Set this one as default\n        const { data, error } = await serverClient.from(\"payment_methods\").update({\n            is_default: true\n        }).eq(\"id\", id).select().single();\n        if (error) throw error;\n        // Force refresh payment methods cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS);\n        return data;\n    },\n    async delete (id) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        const { error } = await serverClient.from(\"payment_methods\").delete().eq(\"id\", id);\n        if (error) throw error;\n        // Force refresh payment methods cache\n        _cache__WEBPACK_IMPORTED_MODULE_1__.dataCache.invalidate(_cache__WEBPACK_IMPORTED_MODULE_1__.CACHE_KEYS.PAYMENT_METHODS);\n    }\n};\n// Admin operations\nconst adminService = {\n    async verifyAdmin (email, password) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        const { data: admin, error } = await serverClient.from(\"admin_users\").select(\"*\").eq(\"email\", email).eq(\"status\", \"active\").single();\n        if (error || !admin) return null;\n        // Since we removed password_hash, we need to use Supabase Auth for admin login too\n        // This is a simplified approach - in production, you might want separate admin auth\n        return admin;\n    },\n    async getAllTransactions (filters = {}) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        let query = serverClient.from(\"transactions\").select(`\r\n        *,\r\n        recipient:recipients(*),\r\n        user:users(first_name, last_name, email)\r\n      `);\n        if (filters.status && filters.status !== \"all\") {\n            query = query.eq(\"status\", filters.status);\n        }\n        if (filters.currency && filters.currency !== \"all\") {\n            query = query.or(`send_currency.eq.${filters.currency},receive_currency.eq.${filters.currency}`);\n        }\n        if (filters.search) {\n            query = query.or(`transaction_id.ilike.%${filters.search}%,user.email.ilike.%${filters.search}%`);\n        }\n        const { data, error } = await query.order(\"created_at\", {\n            ascending: false\n        }).limit(filters.limit || 50);\n        if (error) throw error;\n        return data;\n    },\n    async getAllUsers (filters = {}) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        let query = serverClient.from(\"users\").select(\"*\");\n        if (filters.status && filters.status !== \"all\") {\n            query = query.eq(\"status\", filters.status);\n        }\n        if (filters.verification && filters.verification !== \"all\") {\n            query = query.eq(\"verification_status\", filters.verification);\n        }\n        if (filters.search) {\n            query = query.or(`email.ilike.%${filters.search}%,first_name.ilike.%${filters.search}%,last_name.ilike.%${filters.search}%`);\n        }\n        const { data, error } = await query.order(\"created_at\", {\n            ascending: false\n        }).limit(filters.limit || 50);\n        if (error) throw error;\n        return data;\n    }\n};\n// System settings operations\nconst settingsService = {\n    async get (key) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"system_settings\").select(\"value, data_type\").eq(\"key\", key).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        if (!data) return null;\n        // Parse value based on data type\n        switch(data.data_type){\n            case \"boolean\":\n                return data.value === \"true\";\n            case \"number\":\n                return Number(data.value);\n            case \"json\":\n                return JSON.parse(data.value);\n            default:\n                return data.value;\n        }\n    },\n    async set (key, value, dataType = \"string\") {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        // Convert value to string for storage\n        let stringValue;\n        switch(dataType){\n            case \"boolean\":\n                stringValue = value ? \"true\" : \"false\";\n                break;\n            case \"number\":\n                stringValue = String(value);\n                break;\n            case \"json\":\n                stringValue = JSON.stringify(value);\n                break;\n            default:\n                stringValue = String(value);\n        }\n        const { data, error } = await serverClient.from(\"system_settings\").upsert({\n            key,\n            value: stringValue,\n            data_type: dataType\n        }).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async getAll () {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"system_settings\").select(\"*\").order(\"key\");\n        if (error) throw error;\n        return data;\n    },\n    async getByCategory (category) {\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"system_settings\").select(\"*\").eq(\"category\", category).eq(\"is_active\", true).order(\"key\");\n        if (error) throw error;\n        return data;\n    },\n    async updateMultiple (settings) {\n        const serverClient = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.createServerClient)();\n        const updates = settings.map(({ key, value, dataType = \"string\" })=>{\n            let stringValue;\n            switch(dataType){\n                case \"boolean\":\n                    stringValue = value ? \"true\" : \"false\";\n                    break;\n                case \"number\":\n                    stringValue = String(value);\n                    break;\n                case \"json\":\n                    stringValue = JSON.stringify(value);\n                    break;\n                default:\n                    stringValue = String(value);\n            }\n            return {\n                key,\n                value: stringValue,\n                data_type: dataType\n            };\n        });\n        const { data, error } = await serverClient.from(\"system_settings\").upsert(updates).select();\n        if (error) throw error;\n        return data;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RVQsSUFBSWxDLE9BQU8sTUFBTUE7UUFDakIsT0FBT0Q7SUFDVDtJQUVBLE1BQU1nTixnQkFBZUMsUUFBK0Q7UUFDbEYsTUFBTXJDLGVBQWVsTCw2REFBa0JBO1FBRXZDLE1BQU1lLFVBQVV3TSxTQUFTN0ssR0FBRyxDQUFDLENBQUMsRUFBRWlLLEdBQUcsRUFBRUUsS0FBSyxFQUFFRyxXQUFXLFFBQVEsRUFBRTtZQUMvRCxJQUFJQztZQUNKLE9BQVFEO2dCQUNOLEtBQUs7b0JBQ0hDLGNBQWNKLFFBQVEsU0FBUztvQkFDL0I7Z0JBQ0YsS0FBSztvQkFDSEksY0FBY0MsT0FBT0w7b0JBQ3JCO2dCQUNGLEtBQUs7b0JBQ0hJLGNBQWNILEtBQUtLLFNBQVMsQ0FBQ047b0JBQzdCO2dCQUNGO29CQUNFSSxjQUFjQyxPQUFPTDtZQUN6QjtZQUVBLE9BQU87Z0JBQUVGO2dCQUFLRSxPQUFPSTtnQkFBYUwsV0FBV0k7WUFBUztRQUN4RDtRQUVBLE1BQU0sRUFBRTFNLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTTJLLGFBQWExSyxJQUFJLENBQUMsbUJBQW1Cd0QsTUFBTSxDQUFDakQsU0FBU04sTUFBTTtRQUV6RixJQUFJRixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9EO0lBQ1Q7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZWFzbmVyLy4vbGliL2RhdGFiYXNlLnRzPzRkNDkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UsIGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gXCIuL3N1cGFiYXNlXCJcclxuaW1wb3J0IHsgZGF0YUNhY2hlLCBDQUNIRV9LRVlTIH0gZnJvbSBcIi4vY2FjaGVcIlxyXG5cclxuLy8gVXNlciBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCB1c2VyU2VydmljZSA9IHtcclxuICBhc3luYyBmaW5kQnlFbWFpbChlbWFpbDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKFwidXNlcnNcIikuc2VsZWN0KFwiKlwiKS5lcShcImVtYWlsXCIsIGVtYWlsKS5zaW5nbGUoKVxyXG5cclxuICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSBcIlBHUlNUMTE2XCIpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZVByb2ZpbGUoXHJcbiAgICB1c2VySWQ6IHN0cmluZyxcclxuICAgIHVwZGF0ZXM6IHtcclxuICAgICAgZmlyc3ROYW1lPzogc3RyaW5nXHJcbiAgICAgIGxhc3ROYW1lPzogc3RyaW5nXHJcbiAgICAgIHBob25lPzogc3RyaW5nXHJcbiAgICAgIGJhc2VDdXJyZW5jeT86IHN0cmluZ1xyXG4gICAgfSxcclxuICApIHtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidXNlcnNcIilcclxuICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgZmlyc3RfbmFtZTogdXBkYXRlcy5maXJzdE5hbWUsXHJcbiAgICAgICAgbGFzdF9uYW1lOiB1cGRhdGVzLmxhc3ROYW1lLFxyXG4gICAgICAgIHBob25lOiB1cGRhdGVzLnBob25lLFxyXG4gICAgICAgIGJhc2VfY3VycmVuY3k6IHVwZGF0ZXMuYmFzZUN1cnJlbmN5LFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKFwiaWRcIiwgdXNlcklkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEludmFsaWRhdGUgdXNlciBwcm9maWxlIGNhY2hlXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLlVTRVJfUFJPRklMRSh1c2VySWQpKVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZ2V0U3RhdHMoKSB7XHJcbiAgICBjb25zdCB7IGRhdGE6IHRvdGFsVXNlcnMgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oXCJ1c2Vyc1wiKS5zZWxlY3QoXCJpZFwiLCB7IGNvdW50OiBcImV4YWN0XCIgfSlcclxuXHJcbiAgICBjb25zdCB7IGRhdGE6IGFjdGl2ZVVzZXJzIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKFwidXNlcnNcIikuc2VsZWN0KFwiaWRcIiwgeyBjb3VudDogXCJleGFjdFwiIH0pLmVxKFwic3RhdHVzXCIsIFwiYWN0aXZlXCIpXHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiB2ZXJpZmllZFVzZXJzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcInVzZXJzXCIpXHJcbiAgICAgIC5zZWxlY3QoXCJpZFwiLCB7IGNvdW50OiBcImV4YWN0XCIgfSlcclxuICAgICAgLmVxKFwidmVyaWZpY2F0aW9uX3N0YXR1c1wiLCBcInZlcmlmaWVkXCIpXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWw6IHRvdGFsVXNlcnM/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICBhY3RpdmU6IGFjdGl2ZVVzZXJzPy5sZW5ndGggfHwgMCxcclxuICAgICAgdmVyaWZpZWQ6IHZlcmlmaWVkVXNlcnM/Lmxlbmd0aCB8fCAwLFxyXG4gICAgfVxyXG4gIH0sXHJcbn1cclxuXHJcbi8vIEN1cnJlbmN5IG9wZXJhdGlvbnMgd2l0aCBzdGFsZS13aGlsZS1yZXZhbGlkYXRlIGNhY2hpbmdcclxuZXhwb3J0IGNvbnN0IGN1cnJlbmN5U2VydmljZSA9IHtcclxuICBhc3luYyBnZXRBbGwoKSB7XHJcbiAgICBjb25zdCByZWZyZXNoRm4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJjdXJyZW5jaWVzXCIpXHJcbiAgICAgICAgLnNlbGVjdChcImlkLCBjb2RlLCBuYW1lLCBzeW1ib2wsIGZsYWdfc3ZnLCBzdGF0dXMsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXRcIilcclxuICAgICAgICAuZXEoXCJzdGF0dXNcIiwgXCJhY3RpdmVcIilcclxuICAgICAgICAub3JkZXIoXCJjb2RlXCIpXHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIGRhdGE/Lm1hcCgoY3VycmVuY3kpID0+ICh7XHJcbiAgICAgICAgICAuLi5jdXJyZW5jeSxcclxuICAgICAgICAgIGZsYWc6IGN1cnJlbmN5LmZsYWdfc3ZnLFxyXG4gICAgICAgIH0pKSB8fCBbXVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IGNhY2hlIGZpcnN0IHdpdGggYmFja2dyb3VuZCByZWZyZXNoXHJcbiAgICBjb25zdCBjYWNoZWQgPSBkYXRhQ2FjaGUuZ2V0V2l0aFJlZnJlc2goQ0FDSEVfS0VZUy5DVVJSRU5DSUVTLCByZWZyZXNoRm4pXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWRcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBubyBjYWNoZSwgZmV0Y2ggZnJlc2ggZGF0YVxyXG4gICAgY29uc3QgY3VycmVuY2llcyA9IGF3YWl0IHJlZnJlc2hGbigpXHJcbiAgICBkYXRhQ2FjaGUuc2V0KENBQ0hFX0tFWVMuQ1VSUkVOQ0lFUywgY3VycmVuY2llcywgNSAqIDYwICogMTAwMCkgLy8gNSBtaW51dGVzXHJcbiAgICByZXR1cm4gY3VycmVuY2llc1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEV4Y2hhbmdlUmF0ZXMoKSB7XHJcbiAgICBjb25zdCByZWZyZXNoRm4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJleGNoYW5nZV9yYXRlc1wiKVxyXG4gICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgKixcclxuICAgICAgICAgIGZyb21fY3VycmVuY3lfaW5mbzpjdXJyZW5jaWVzIWV4Y2hhbmdlX3JhdGVzX2Zyb21fY3VycmVuY3lfZmtleShpZCwgY29kZSwgbmFtZSwgc3ltYm9sLCBmbGFnX3N2ZyksXHJcbiAgICAgICAgICB0b19jdXJyZW5jeV9pbmZvOmN1cnJlbmNpZXMhZXhjaGFuZ2VfcmF0ZXNfdG9fY3VycmVuY3lfZmtleShpZCwgY29kZSwgbmFtZSwgc3ltYm9sLCBmbGFnX3N2ZylcclxuICAgICAgICBgKVxyXG4gICAgICAgIC5lcShcInN0YXR1c1wiLCBcImFjdGl2ZVwiKVxyXG5cclxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgICAgcmV0dXJuIChcclxuICAgICAgICBkYXRhPy5tYXAoKHJhdGUpID0+ICh7XHJcbiAgICAgICAgICAuLi5yYXRlLFxyXG4gICAgICAgICAgZnJvbV9jdXJyZW5jeV9pbmZvOiByYXRlLmZyb21fY3VycmVuY3lfaW5mb1xyXG4gICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgIC4uLnJhdGUuZnJvbV9jdXJyZW5jeV9pbmZvLFxyXG4gICAgICAgICAgICAgICAgZmxhZzogcmF0ZS5mcm9tX2N1cnJlbmN5X2luZm8uZmxhZ19zdmcsXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIHRvX2N1cnJlbmN5X2luZm86IHJhdGUudG9fY3VycmVuY3lfaW5mb1xyXG4gICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgIC4uLnJhdGUudG9fY3VycmVuY3lfaW5mbyxcclxuICAgICAgICAgICAgICAgIGZsYWc6IHJhdGUudG9fY3VycmVuY3lfaW5mby5mbGFnX3N2ZyxcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDogdW5kZWZpbmVkLFxyXG4gICAgICAgIH0pKSB8fCBbXVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IGNhY2hlIGZpcnN0IHdpdGggYmFja2dyb3VuZCByZWZyZXNoXHJcbiAgICBjb25zdCBjYWNoZWQgPSBkYXRhQ2FjaGUuZ2V0V2l0aFJlZnJlc2goQ0FDSEVfS0VZUy5FWENIQU5HRV9SQVRFUywgcmVmcmVzaEZuKVxyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICByZXR1cm4gY2FjaGVkXHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gY2FjaGUsIGZldGNoIGZyZXNoIGRhdGFcclxuICAgIGNvbnN0IHJhdGVzID0gYXdhaXQgcmVmcmVzaEZuKClcclxuICAgIGRhdGFDYWNoZS5zZXQoQ0FDSEVfS0VZUy5FWENIQU5HRV9SQVRFUywgcmF0ZXMsIDIgKiA2MCAqIDEwMDApIC8vIDIgbWludXRlc1xyXG4gICAgcmV0dXJuIHJhdGVzXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZ2V0UmF0ZShmcm9tQ3VycmVuY3k6IHN0cmluZywgdG9DdXJyZW5jeTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcImV4Y2hhbmdlX3JhdGVzXCIpXHJcbiAgICAgIC5zZWxlY3QoXCIqXCIpXHJcbiAgICAgIC5lcShcImZyb21fY3VycmVuY3lcIiwgZnJvbUN1cnJlbmN5KVxyXG4gICAgICAuZXEoXCJ0b19jdXJyZW5jeVwiLCB0b0N1cnJlbmN5KVxyXG4gICAgICAuZXEoXCJzdGF0dXNcIiwgXCJhY3RpdmVcIilcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiUEdSU1QxMTZcIikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlUmF0ZShmcm9tQ3VycmVuY3k6IHN0cmluZywgdG9DdXJyZW5jeTogc3RyaW5nLCByYXRlOiBudW1iZXIsIGZlZVR5cGUgPSBcImZyZWVcIiwgZmVlQW1vdW50ID0gMCkge1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJleGNoYW5nZV9yYXRlc1wiKVxyXG4gICAgICAudXBzZXJ0KHtcclxuICAgICAgICBmcm9tX2N1cnJlbmN5OiBmcm9tQ3VycmVuY3ksXHJcbiAgICAgICAgdG9fY3VycmVuY3k6IHRvQ3VycmVuY3ksXHJcbiAgICAgICAgcmF0ZSxcclxuICAgICAgICBmZWVfdHlwZTogZmVlVHlwZSxcclxuICAgICAgICBmZWVfYW1vdW50OiBmZWVBbW91bnQsXHJcbiAgICAgICAgc3RhdHVzOiBcImFjdGl2ZVwiLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKVxyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuXHJcbiAgICAvLyBGb3JjZSByZWZyZXNoIGV4Y2hhbmdlIHJhdGVzIGNhY2hlXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLkVYQ0hBTkdFX1JBVEVTKVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxufVxyXG5cclxuLy8gUmVjaXBpZW50IG9wZXJhdGlvbnMgd2l0aCBpbXByb3ZlZCBjYWNoaW5nXHJcbmV4cG9ydCBjb25zdCByZWNpcGllbnRTZXJ2aWNlID0ge1xyXG4gIGFzeW5jIGNyZWF0ZShcclxuICAgIHVzZXJJZDogc3RyaW5nLFxyXG4gICAgcmVjaXBpZW50RGF0YToge1xyXG4gICAgICBmdWxsTmFtZTogc3RyaW5nXHJcbiAgICAgIGFjY291bnROdW1iZXI6IHN0cmluZ1xyXG4gICAgICBiYW5rTmFtZTogc3RyaW5nXHJcbiAgICAgIHBob25lTnVtYmVyPzogc3RyaW5nXHJcbiAgICAgIGN1cnJlbmN5OiBzdHJpbmdcclxuICAgIH0sXHJcbiAgKSB7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcInJlY2lwaWVudHNcIilcclxuICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICAgIGZ1bGxfbmFtZTogcmVjaXBpZW50RGF0YS5mdWxsTmFtZSxcclxuICAgICAgICBhY2NvdW50X251bWJlcjogcmVjaXBpZW50RGF0YS5hY2NvdW50TnVtYmVyLFxyXG4gICAgICAgIGJhbmtfbmFtZTogcmVjaXBpZW50RGF0YS5iYW5rTmFtZSxcclxuICAgICAgICBwaG9uZV9udW1iZXI6IHJlY2lwaWVudERhdGEucGhvbmVOdW1iZXIsXHJcbiAgICAgICAgY3VycmVuY3k6IHJlY2lwaWVudERhdGEuY3VycmVuY3ksXHJcbiAgICAgIH0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKClcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgLy8gRm9yY2UgcmVmcmVzaCB1c2VyIHJlY2lwaWVudHMgY2FjaGVcclxuICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlKENBQ0hFX0tFWVMuVVNFUl9SRUNJUElFTlRTKHVzZXJJZCkpXHJcblxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBnZXRCeVVzZXJJZCh1c2VySWQ6IHN0cmluZywgcmVxdWVzdGluZ1VzZXJJZD86IHN0cmluZykge1xyXG4gICAgLy8gVmFsaWRhdGUgdXNlciBhY2Nlc3MgaWYgcmVxdWVzdGluZ1VzZXJJZCBpcyBwcm92aWRlZFxyXG4gICAgaWYgKHJlcXVlc3RpbmdVc2VySWQgJiYgcmVxdWVzdGluZ1VzZXJJZCAhPT0gdXNlcklkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFjY2VzcyBkZW5pZWQ6IFlvdSBjYW4gb25seSB2aWV3IHlvdXIgb3duIHJlY2lwaWVudHNcIilcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZWZyZXNoRm4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJyZWNpcGllbnRzXCIpXHJcbiAgICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZClcclxuICAgICAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG5cclxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgICByZXR1cm4gZGF0YSB8fCBbXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyeSBjYWNoZSBmaXJzdCB3aXRoIGJhY2tncm91bmQgcmVmcmVzaFxyXG4gICAgY29uc3QgY2FjaGVkID0gZGF0YUNhY2hlLmdldFdpdGhSZWZyZXNoKENBQ0hFX0tFWVMuVVNFUl9SRUNJUElFTlRTKHVzZXJJZCksIHJlZnJlc2hGbilcclxuICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgcmV0dXJuIGNhY2hlZFxyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIGNhY2hlLCBmZXRjaCBmcmVzaCBkYXRhXHJcbiAgICBjb25zdCByZWNpcGllbnRzID0gYXdhaXQgcmVmcmVzaEZuKClcclxuICAgIGRhdGFDYWNoZS5zZXQoQ0FDSEVfS0VZUy5VU0VSX1JFQ0lQSUVOVFModXNlcklkKSwgcmVjaXBpZW50cywgMiAqIDYwICogMTAwMCkgLy8gMiBtaW51dGVzXHJcbiAgICByZXR1cm4gcmVjaXBpZW50c1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZShcclxuICAgIHJlY2lwaWVudElkOiBzdHJpbmcsXHJcbiAgICB1cGRhdGVzOiB7XHJcbiAgICAgIGZ1bGxOYW1lPzogc3RyaW5nXHJcbiAgICAgIGFjY291bnROdW1iZXI/OiBzdHJpbmdcclxuICAgICAgYmFua05hbWU/OiBzdHJpbmdcclxuICAgICAgcGhvbmVOdW1iZXI/OiBzdHJpbmdcclxuICAgIH0sXHJcbiAgKSB7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcInJlY2lwaWVudHNcIilcclxuICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgZnVsbF9uYW1lOiB1cGRhdGVzLmZ1bGxOYW1lLFxyXG4gICAgICAgIGFjY291bnRfbnVtYmVyOiB1cGRhdGVzLmFjY291bnROdW1iZXIsXHJcbiAgICAgICAgYmFua19uYW1lOiB1cGRhdGVzLmJhbmtOYW1lLFxyXG4gICAgICAgIHBob25lX251bWJlcjogdXBkYXRlcy5waG9uZU51bWJlcixcclxuICAgICAgfSlcclxuICAgICAgLmVxKFwiaWRcIiwgcmVjaXBpZW50SWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKClcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgLy8gSW52YWxpZGF0ZSByZWxhdGVkIGNhY2hlc1xyXG4gICAgZGF0YUNhY2hlLmludmFsaWRhdGVQYXR0ZXJuKFwidXNlcl9yZWNpcGllbnRzX1wiKVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZGVsZXRlKHJlY2lwaWVudElkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oXCJyZWNpcGllbnRzXCIpLmRlbGV0ZSgpLmVxKFwiaWRcIiwgcmVjaXBpZW50SWQpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEludmFsaWRhdGUgcmVsYXRlZCBjYWNoZXNcclxuICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlUGF0dGVybihcInVzZXJfcmVjaXBpZW50c19cIilcclxuICB9LFxyXG59XHJcblxyXG4vLyBUcmFuc2FjdGlvbiBvcGVyYXRpb25zIHdpdGggZW5oYW5jZWQgYWNjZXNzIGNvbnRyb2xcclxuZXhwb3J0IGNvbnN0IHRyYW5zYWN0aW9uU2VydmljZSA9IHtcclxuICBhc3luYyBjcmVhdGUodHJhbnNhY3Rpb25EYXRhOiB7XHJcbiAgICB1c2VySWQ6IHN0cmluZ1xyXG4gICAgcmVjaXBpZW50SWQ6IHN0cmluZ1xyXG4gICAgc2VuZEFtb3VudDogbnVtYmVyXHJcbiAgICBzZW5kQ3VycmVuY3k6IHN0cmluZ1xyXG4gICAgcmVjZWl2ZUFtb3VudDogbnVtYmVyXHJcbiAgICByZWNlaXZlQ3VycmVuY3k6IHN0cmluZ1xyXG4gICAgZXhjaGFuZ2VSYXRlOiBudW1iZXJcclxuICAgIGZlZUFtb3VudDogbnVtYmVyXHJcbiAgICBmZWVUeXBlOiBzdHJpbmdcclxuICAgIHRvdGFsQW1vdW50OiBudW1iZXJcclxuICAgIHJlZmVyZW5jZT86IHN0cmluZ1xyXG4gIH0sIHJlcXVlc3RpbmdVc2VySWQ/OiBzdHJpbmcpIHtcclxuICAgIC8vIFZhbGlkYXRlIHVzZXIgYWNjZXNzIGlmIHJlcXVlc3RpbmdVc2VySWQgaXMgcHJvdmlkZWRcclxuICAgIGlmIChyZXF1ZXN0aW5nVXNlcklkICYmIHJlcXVlc3RpbmdVc2VySWQgIT09IHRyYW5zYWN0aW9uRGF0YS51c2VySWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWNjZXNzIGRlbmllZDogWW91IGNhbiBvbmx5IGNyZWF0ZSB0cmFuc2FjdGlvbnMgZm9yIHlvdXJzZWxmXCIpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHJhbnNhY3Rpb25JZCA9IGBFVElEJHtEYXRlLm5vdygpfWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBZGQgdGltZW91dCB0byBwcmV2ZW50IGhhbmdpbmdcclxuICAgICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PlxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcihcIlRyYW5zYWN0aW9uIGNyZWF0aW9uIHRpbWVvdXRcIikpLCAxNTAwMCksXHJcbiAgICAgIClcclxuXHJcbiAgICAgIGNvbnN0IGNyZWF0ZVByb21pc2UgPSBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpXHJcbiAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICB0cmFuc2FjdGlvbl9pZDogdHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgIHVzZXJfaWQ6IHRyYW5zYWN0aW9uRGF0YS51c2VySWQsXHJcbiAgICAgICAgICByZWNpcGllbnRfaWQ6IHRyYW5zYWN0aW9uRGF0YS5yZWNpcGllbnRJZCxcclxuICAgICAgICAgIHNlbmRfYW1vdW50OiB0cmFuc2FjdGlvbkRhdGEuc2VuZEFtb3VudCxcclxuICAgICAgICAgIHNlbmRfY3VycmVuY3k6IHRyYW5zYWN0aW9uRGF0YS5zZW5kQ3VycmVuY3ksXHJcbiAgICAgICAgICByZWNlaXZlX2Ftb3VudDogdHJhbnNhY3Rpb25EYXRhLnJlY2VpdmVBbW91bnQsXHJcbiAgICAgICAgICByZWNlaXZlX2N1cnJlbmN5OiB0cmFuc2FjdGlvbkRhdGEucmVjZWl2ZUN1cnJlbmN5LFxyXG4gICAgICAgICAgZXhjaGFuZ2VfcmF0ZTogdHJhbnNhY3Rpb25EYXRhLmV4Y2hhbmdlUmF0ZSxcclxuICAgICAgICAgIGZlZV9hbW91bnQ6IHRyYW5zYWN0aW9uRGF0YS5mZWVBbW91bnQsXHJcbiAgICAgICAgICBmZWVfdHlwZTogdHJhbnNhY3Rpb25EYXRhLmZlZVR5cGUsXHJcbiAgICAgICAgICB0b3RhbF9hbW91bnQ6IHRyYW5zYWN0aW9uRGF0YS50b3RhbEFtb3VudCxcclxuICAgICAgICAgIHJlZmVyZW5jZTogdHJhbnNhY3Rpb25EYXRhLnJlZmVyZW5jZSxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgIC5zaW5nbGUoKVxyXG5cclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gKGF3YWl0IFByb21pc2UucmFjZShbY3JlYXRlUHJvbWlzZSwgdGltZW91dFByb21pc2VdKSkgYXMgYW55XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgICAvLyBGb3JjZSByZWZyZXNoIHVzZXIgdHJhbnNhY3Rpb25zIGNhY2hlXHJcbiAgICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlKENBQ0hFX0tFWVMuVVNFUl9UUkFOU0FDVElPTlModHJhbnNhY3Rpb25EYXRhLnVzZXJJZCkpXHJcblxyXG4gICAgICByZXR1cm4gZGF0YVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIlRyYW5zYWN0aW9uIGNyZWF0aW9uIGVycm9yOlwiLCBlcnJvcilcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSB0cmFuc2FjdGlvbi4gUGxlYXNlIGNoZWNrIHlvdXIgY29ubmVjdGlvbiBhbmQgdHJ5IGFnYWluLlwiKVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEJ5VXNlcklkKHVzZXJJZDogc3RyaW5nLCBsaW1pdCA9IDIwLCByZXF1ZXN0aW5nVXNlcklkPzogc3RyaW5nKSB7XHJcbiAgICAvLyBWYWxpZGF0ZSB1c2VyIGFjY2VzcyBpZiByZXF1ZXN0aW5nVXNlcklkIGlzIHByb3ZpZGVkXHJcbiAgICBpZiAocmVxdWVzdGluZ1VzZXJJZCAmJiByZXF1ZXN0aW5nVXNlcklkICE9PSB1c2VySWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWNjZXNzIGRlbmllZDogWW91IGNhbiBvbmx5IHZpZXcgeW91ciBvd24gdHJhbnNhY3Rpb25zXCIpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVmcmVzaEZuID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpXHJcbiAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICAqLFxyXG4gICAgICAgICAgcmVjaXBpZW50OnJlY2lwaWVudHMoKilcclxuICAgICAgICBgKVxyXG4gICAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXHJcbiAgICAgICAgLmxpbWl0KGxpbWl0KVxyXG5cclxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgICByZXR1cm4gZGF0YSB8fCBbXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyeSBjYWNoZSBmaXJzdCB3aXRoIGJhY2tncm91bmQgcmVmcmVzaFxyXG4gICAgY29uc3QgY2FjaGVkID0gZGF0YUNhY2hlLmdldFdpdGhSZWZyZXNoKENBQ0hFX0tFWVMuVVNFUl9UUkFOU0FDVElPTlModXNlcklkKSwgcmVmcmVzaEZuKVxyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICByZXR1cm4gY2FjaGVkXHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gY2FjaGUsIGZldGNoIGZyZXNoIGRhdGFcclxuICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IHJlZnJlc2hGbigpXHJcbiAgICBkYXRhQ2FjaGUuc2V0KENBQ0hFX0tFWVMuVVNFUl9UUkFOU0FDVElPTlModXNlcklkKSwgdHJhbnNhY3Rpb25zLCAxICogNjAgKiAxMDAwKSAvLyAxIG1pbnV0ZVxyXG4gICAgcmV0dXJuIHRyYW5zYWN0aW9uc1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEJ5SWQodHJhbnNhY3Rpb25JZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCByZWZyZXNoRm4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJ0cmFuc2FjdGlvbnNcIilcclxuICAgICAgICAuc2VsZWN0KGBcclxuICAgICAgICAgICosXHJcbiAgICAgICAgICByZWNpcGllbnQ6cmVjaXBpZW50cygqKSxcclxuICAgICAgICAgIHVzZXI6dXNlcnMoZmlyc3RfbmFtZSwgbGFzdF9uYW1lLCBlbWFpbClcclxuICAgICAgICBgKVxyXG4gICAgICAgIC5lcShcInRyYW5zYWN0aW9uX2lkXCIsIHRyYW5zYWN0aW9uSWQpXHJcbiAgICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgICAgIHJldHVybiBkYXRhXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IGNhY2hlIGZpcnN0IHdpdGggYmFja2dyb3VuZCByZWZyZXNoXHJcbiAgICBjb25zdCBjYWNoZWQgPSBkYXRhQ2FjaGUuZ2V0V2l0aFJlZnJlc2goQ0FDSEVfS0VZUy5UUkFOU0FDVElPTih0cmFuc2FjdGlvbklkKSwgcmVmcmVzaEZuKVxyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICByZXR1cm4gY2FjaGVkXHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gY2FjaGUsIGZldGNoIGZyZXNoIGRhdGFcclxuICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgcmVmcmVzaEZuKClcclxuICAgIGNvbnN0IHR0bCA9IHRyYW5zYWN0aW9uLnN0YXR1cyA9PT0gXCJjb21wbGV0ZWRcIiA/IDUgKiA2MCAqIDEwMDAgOiAzMCAqIDEwMDAgLy8gNSBtaW4gZm9yIGNvbXBsZXRlZCwgMzBzIGZvciBhY3RpdmVcclxuICAgIGRhdGFDYWNoZS5zZXQoQ0FDSEVfS0VZUy5UUkFOU0FDVElPTih0cmFuc2FjdGlvbklkKSwgdHJhbnNhY3Rpb24sIHR0bClcclxuICAgIHJldHVybiB0cmFuc2FjdGlvblxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZVN0YXR1cyh0cmFuc2FjdGlvbklkOiBzdHJpbmcsIHN0YXR1czogc3RyaW5nKSB7XHJcbiAgICBjb25zdCB1cGRhdGVzOiBhbnkgPSB7IHN0YXR1cyB9XHJcbiAgICBpZiAoc3RhdHVzID09PSBcImNvbXBsZXRlZFwiKSB7XHJcbiAgICAgIHVwZGF0ZXMuY29tcGxldGVkX2F0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJ0cmFuc2FjdGlvbnNcIilcclxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxyXG4gICAgICAuZXEoXCJ0cmFuc2FjdGlvbl9pZFwiLCB0cmFuc2FjdGlvbklkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEZvcmNlIHJlZnJlc2ggdHJhbnNhY3Rpb24gY2FjaGVcclxuICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlKENBQ0hFX0tFWVMuVFJBTlNBQ1RJT04odHJhbnNhY3Rpb25JZCkpXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZVBhdHRlcm4oXCJ1c2VyX3RyYW5zYWN0aW9uc19cIilcclxuXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwbG9hZFJlY2VpcHQodHJhbnNhY3Rpb25JZDogc3RyaW5nLCBmaWxlOiBGaWxlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBGaXJzdCBjaGVjayBpZiB0cmFuc2FjdGlvbiBleGlzdHMgd2l0aCB0aW1lb3V0XHJcbiAgICAgIGNvbnN0IHRpbWVvdXRQcm9taXNlID0gbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoXCJUcmFuc2FjdGlvbiBjaGVjayB0aW1lb3V0XCIpKSwgMTAwMDApLFxyXG4gICAgICApXHJcblxyXG4gICAgICBjb25zdCBjaGVja1Byb21pc2UgPSBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpXHJcbiAgICAgICAgLnNlbGVjdChcImlkLCB0cmFuc2FjdGlvbl9pZFwiKVxyXG4gICAgICAgIC5lcShcInRyYW5zYWN0aW9uX2lkXCIsIHRyYW5zYWN0aW9uSWQpXHJcbiAgICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nVHJhbnNhY3Rpb24sIGVycm9yOiBjaGVja0Vycm9yIH0gPSAoYXdhaXQgUHJvbWlzZS5yYWNlKFtcclxuICAgICAgICBjaGVja1Byb21pc2UsXHJcbiAgICAgICAgdGltZW91dFByb21pc2UsXHJcbiAgICAgIF0pKSBhcyBhbnlcclxuXHJcbiAgICAgIGlmIChjaGVja0Vycm9yIHx8ICFleGlzdGluZ1RyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlRyYW5zYWN0aW9uIGNoZWNrIGVycm9yOlwiLCBjaGVja0Vycm9yKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zYWN0aW9uIG5vdCBmb3VuZC4gUGxlYXNlIGNyZWF0ZSB0aGUgdHJhbnNhY3Rpb24gZmlyc3QuXCIpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBmaWxlbmFtZVxyXG4gICAgICBjb25zdCBmaWxlRXh0ID0gZmlsZS5uYW1lLnNwbGl0KFwiLlwiKS5wb3AoKVxyXG4gICAgICBjb25zdCBmaWxlTmFtZSA9IGAke3RyYW5zYWN0aW9uSWR9LiR7ZmlsZUV4dH1gXHJcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gYHJlY2VpcHRzLyR7ZmlsZU5hbWV9YFxyXG5cclxuICAgICAgLy8gVXBsb2FkIGZpbGUgdG8gU3VwYWJhc2UgU3RvcmFnZSB3aXRoIHRpbWVvdXRcclxuICAgICAgY29uc3QgdXBsb2FkVGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PlxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcihcIlVwbG9hZCB0aW1lb3V0XCIpKSwgMzAwMDApLFxyXG4gICAgICApXHJcblxyXG4gICAgICBjb25zdCB1cGxvYWRQcm9taXNlID0gc3VwYWJhc2Uuc3RvcmFnZS5mcm9tKFwidHJhbnNhY3Rpb24tcmVjZWlwdHNcIikudXBsb2FkKGZpbGVQYXRoLCBmaWxlLCB7XHJcbiAgICAgICAgY2FjaGVDb250cm9sOiBcIjM2MDBcIixcclxuICAgICAgICB1cHNlcnQ6IGZhbHNlLFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc3QgeyBkYXRhOiB1cGxvYWREYXRhLCBlcnJvcjogdXBsb2FkRXJyb3IgfSA9IChhd2FpdCBQcm9taXNlLnJhY2UoW1xyXG4gICAgICAgIHVwbG9hZFByb21pc2UsXHJcbiAgICAgICAgdXBsb2FkVGltZW91dFByb21pc2UsXHJcbiAgICAgIF0pKSBhcyBhbnlcclxuXHJcbiAgICAgIGlmICh1cGxvYWRFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVcGxvYWQgZXJyb3I6XCIsIHVwbG9hZEVycm9yKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVXBsb2FkIGZhaWxlZDogJHt1cGxvYWRFcnJvci5tZXNzYWdlfWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCBwdWJsaWMgVVJMXHJcbiAgICAgIGNvbnN0IHtcclxuICAgICAgICBkYXRhOiB7IHB1YmxpY1VybCB9LFxyXG4gICAgICB9ID0gc3VwYWJhc2Uuc3RvcmFnZS5mcm9tKFwidHJhbnNhY3Rpb24tcmVjZWlwdHNcIikuZ2V0UHVibGljVXJsKGZpbGVQYXRoKVxyXG5cclxuICAgICAgLy8gVXBkYXRlIHRyYW5zYWN0aW9uIHdpdGggcmVjZWlwdCBVUkxcclxuICAgICAgY29uc3QgdXBkYXRlVGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PlxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcihcIkRhdGFiYXNlIHVwZGF0ZSB0aW1lb3V0XCIpKSwgMTAwMDApLFxyXG4gICAgICApXHJcblxyXG4gICAgICBjb25zdCB1cGRhdGVQcm9taXNlID0gc3VwYWJhc2VcclxuICAgICAgICAuZnJvbShcInRyYW5zYWN0aW9uc1wiKVxyXG4gICAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgICAgcmVjZWlwdF91cmw6IHB1YmxpY1VybCxcclxuICAgICAgICAgIHJlY2VpcHRfZmlsZW5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmVxKFwidHJhbnNhY3Rpb25faWRcIiwgdHJhbnNhY3Rpb25JZClcclxuICAgICAgICAuc2VsZWN0KClcclxuXHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IChhd2FpdCBQcm9taXNlLnJhY2UoW3VwZGF0ZVByb21pc2UsIHVwZGF0ZVRpbWVvdXRQcm9taXNlXSkpIGFzIGFueVxyXG5cclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIHVwZGF0ZSBlcnJvcjpcIiwgZXJyb3IpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYXRhYmFzZSB1cGRhdGUgZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YClcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSB0cmFuc2FjdGlvbiB3aXRoIHJlY2VpcHRcIilcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgdXBkYXRlZFRyYW5zYWN0aW9uID0gZGF0YVswXVxyXG5cclxuICAgICAgLy8gRm9yY2UgcmVmcmVzaCB0cmFuc2FjdGlvbiBjYWNoZVxyXG4gICAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLlRSQU5TQUNUSU9OKHRyYW5zYWN0aW9uSWQpKVxyXG5cclxuICAgICAgcmV0dXJuIHsgLi4udXBkYXRlZFRyYW5zYWN0aW9uLCByZWNlaXB0X3VybDogcHVibGljVXJsIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZWNlaXB0IHVwbG9hZCBlcnJvcjpcIiwgZXJyb3IpXHJcbiAgICAgIHRocm93IGVycm9yXHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZ2V0U3RhdHModGltZVJhbmdlID0gXCJ0b2RheVwiKSB7XHJcbiAgICBjb25zdCBkYXRlRmlsdGVyID0gbmV3IERhdGUoKVxyXG5cclxuICAgIHN3aXRjaCAodGltZVJhbmdlKSB7XHJcbiAgICAgIGNhc2UgXCJ0b2RheVwiOlxyXG4gICAgICAgIGRhdGVGaWx0ZXIuc2V0SG91cnMoMCwgMCwgMCwgMClcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlIFwid2Vla1wiOlxyXG4gICAgICAgIGRhdGVGaWx0ZXIuc2V0RGF0ZShkYXRlRmlsdGVyLmdldERhdGUoKSAtIDcpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSBcIm1vbnRoXCI6XHJcbiAgICAgICAgZGF0ZUZpbHRlci5zZXRNb250aChkYXRlRmlsdGVyLmdldE1vbnRoKCkgLSAxKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiB0cmFuc2FjdGlvbnMgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpXHJcbiAgICAgIC5zZWxlY3QoXCIqXCIpXHJcbiAgICAgIC5ndGUoXCJjcmVhdGVkX2F0XCIsIGRhdGVGaWx0ZXIudG9JU09TdHJpbmcoKSlcclxuXHJcbiAgICBjb25zdCB7IGRhdGE6IHBlbmRpbmdUcmFuc2FjdGlvbnMgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpXHJcbiAgICAgIC5zZWxlY3QoXCJpZFwiLCB7IGNvdW50OiBcImV4YWN0XCIgfSlcclxuICAgICAgLmluKFwic3RhdHVzXCIsIFtcInBlbmRpbmdcIiwgXCJwcm9jZXNzaW5nXCJdKVxyXG5cclxuICAgIGNvbnN0IHRvdGFsVm9sdW1lID0gdHJhbnNhY3Rpb25zPy5yZWR1Y2UoKHN1bSwgdCkgPT4gc3VtICsgTnVtYmVyKHQuc2VuZF9hbW91bnQpLCAwKSB8fCAwXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxUcmFuc2FjdGlvbnM6IHRyYW5zYWN0aW9ucz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIHRvdGFsVm9sdW1lLFxyXG4gICAgICBwZW5kaW5nVHJhbnNhY3Rpb25zOiBwZW5kaW5nVHJhbnNhY3Rpb25zPy5sZW5ndGggfHwgMCxcclxuICAgIH1cclxuICB9LFxyXG59XHJcblxyXG4vLyBQYXltZW50IE1ldGhvZHMgb3BlcmF0aW9ucyB3aXRoIGltcHJvdmVkIGNhY2hpbmdcclxuZXhwb3J0IGNvbnN0IHBheW1lbnRNZXRob2RTZXJ2aWNlID0ge1xyXG4gIGFzeW5jIGdldEFsbCgpIHtcclxuICAgIGNvbnN0IHJlZnJlc2hGbiA9IGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbShcInBheW1lbnRfbWV0aG9kc1wiKVxyXG4gICAgICAgIC5zZWxlY3QoXCIqXCIpXHJcbiAgICAgICAgLm9yZGVyKFwiY3VycmVuY3lcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSlcclxuICAgICAgICAub3JkZXIoXCJpc19kZWZhdWx0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG5cclxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgICByZXR1cm4gZGF0YSB8fCBbXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyeSBjYWNoZSBmaXJzdCB3aXRoIGJhY2tncm91bmQgcmVmcmVzaFxyXG4gICAgY29uc3QgY2FjaGVkID0gZGF0YUNhY2hlLmdldFdpdGhSZWZyZXNoKENBQ0hFX0tFWVMuUEFZTUVOVF9NRVRIT0RTLCByZWZyZXNoRm4pXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWRcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBubyBjYWNoZSwgZmV0Y2ggZnJlc2ggZGF0YVxyXG4gICAgY29uc3QgbWV0aG9kcyA9IGF3YWl0IHJlZnJlc2hGbigpXHJcbiAgICBkYXRhQ2FjaGUuc2V0KENBQ0hFX0tFWVMuUEFZTUVOVF9NRVRIT0RTLCBtZXRob2RzLCA1ICogNjAgKiAxMDAwKSAvLyA1IG1pbnV0ZXNcclxuICAgIHJldHVybiBtZXRob2RzXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZ2V0QnlDdXJyZW5jeShjdXJyZW5jeTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBhbGxNZXRob2RzID0gYXdhaXQgdGhpcy5nZXRBbGwoKVxyXG4gICAgcmV0dXJuIGFsbE1ldGhvZHMuZmlsdGVyKChwbSkgPT4gcG0uY3VycmVuY3kgPT09IGN1cnJlbmN5ICYmIHBtLnN0YXR1cyA9PT0gXCJhY3RpdmVcIilcclxuICB9LFxyXG5cclxuICBhc3luYyBjcmVhdGUocGF5bWVudE1ldGhvZERhdGE6IHtcclxuICAgIGN1cnJlbmN5OiBzdHJpbmdcclxuICAgIHR5cGU6IHN0cmluZ1xyXG4gICAgbmFtZTogc3RyaW5nXHJcbiAgICBhY2NvdW50TmFtZT86IHN0cmluZ1xyXG4gICAgYWNjb3VudE51bWJlcj86IHN0cmluZ1xyXG4gICAgYmFua05hbWU/OiBzdHJpbmdcclxuICAgIHFyQ29kZURhdGE/OiBzdHJpbmdcclxuICAgIGluc3RydWN0aW9ucz86IHN0cmluZ1xyXG4gICAgaXNEZWZhdWx0PzogYm9vbGVhblxyXG4gIH0pIHtcclxuICAgIGNvbnN0IHNlcnZlckNsaWVudCA9IGNyZWF0ZVNlcnZlckNsaWVudCgpXHJcblxyXG4gICAgLy8gSWYgc2V0dGluZyBhcyBkZWZhdWx0LCB1bnNldCBvdGhlciBkZWZhdWx0cyBmb3IgdGhlIHNhbWUgY3VycmVuY3lcclxuICAgIGlmIChwYXltZW50TWV0aG9kRGF0YS5pc0RlZmF1bHQpIHtcclxuICAgICAgYXdhaXQgc2VydmVyQ2xpZW50XHJcbiAgICAgICAgLmZyb20oXCJwYXltZW50X21ldGhvZHNcIilcclxuICAgICAgICAudXBkYXRlKHsgaXNfZGVmYXVsdDogZmFsc2UgfSlcclxuICAgICAgICAuZXEoXCJjdXJyZW5jeVwiLCBwYXltZW50TWV0aG9kRGF0YS5jdXJyZW5jeSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzZXJ2ZXJDbGllbnRcclxuICAgICAgLmZyb20oXCJwYXltZW50X21ldGhvZHNcIilcclxuICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgY3VycmVuY3k6IHBheW1lbnRNZXRob2REYXRhLmN1cnJlbmN5LFxyXG4gICAgICAgIHR5cGU6IHBheW1lbnRNZXRob2REYXRhLnR5cGUsXHJcbiAgICAgICAgbmFtZTogcGF5bWVudE1ldGhvZERhdGEubmFtZSxcclxuICAgICAgICBhY2NvdW50X25hbWU6IHBheW1lbnRNZXRob2REYXRhLmFjY291bnROYW1lLFxyXG4gICAgICAgIGFjY291bnRfbnVtYmVyOiBwYXltZW50TWV0aG9kRGF0YS5hY2NvdW50TnVtYmVyLFxyXG4gICAgICAgIGJhbmtfbmFtZTogcGF5bWVudE1ldGhvZERhdGEuYmFua05hbWUsXHJcbiAgICAgICAgcXJfY29kZV9kYXRhOiBwYXltZW50TWV0aG9kRGF0YS5xckNvZGVEYXRhLFxyXG4gICAgICAgIGluc3RydWN0aW9uczogcGF5bWVudE1ldGhvZERhdGEuaW5zdHJ1Y3Rpb25zLFxyXG4gICAgICAgIGlzX2RlZmF1bHQ6IHBheW1lbnRNZXRob2REYXRhLmlzRGVmYXVsdCB8fCBmYWxzZSxcclxuICAgICAgICBzdGF0dXM6IFwiYWN0aXZlXCIsXHJcbiAgICAgIH0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKClcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgLy8gRm9yY2UgcmVmcmVzaCBwYXltZW50IG1ldGhvZHMgY2FjaGVcclxuICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlKENBQ0hFX0tFWVMuUEFZTUVOVF9NRVRIT0RTKVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKFxyXG4gICAgaWQ6IHN0cmluZyxcclxuICAgIHVwZGF0ZXM6IHtcclxuICAgICAgY3VycmVuY3k/OiBzdHJpbmdcclxuICAgICAgdHlwZT86IHN0cmluZ1xyXG4gICAgICBuYW1lPzogc3RyaW5nXHJcbiAgICAgIGFjY291bnROYW1lPzogc3RyaW5nXHJcbiAgICAgIGFjY291bnROdW1iZXI/OiBzdHJpbmdcclxuICAgICAgYmFua05hbWU/OiBzdHJpbmdcclxuICAgICAgcXJDb2RlRGF0YT86IHN0cmluZ1xyXG4gICAgICBpbnN0cnVjdGlvbnM/OiBzdHJpbmdcclxuICAgICAgaXNEZWZhdWx0PzogYm9vbGVhblxyXG4gICAgfSxcclxuICApIHtcclxuICAgIGNvbnN0IHNlcnZlckNsaWVudCA9IGNyZWF0ZVNlcnZlckNsaWVudCgpXHJcblxyXG4gICAgLy8gSWYgc2V0dGluZyBhcyBkZWZhdWx0LCB1bnNldCBvdGhlciBkZWZhdWx0cyBmb3IgdGhlIHNhbWUgY3VycmVuY3lcclxuICAgIGlmICh1cGRhdGVzLmlzRGVmYXVsdCAmJiB1cGRhdGVzLmN1cnJlbmN5KSB7XHJcbiAgICAgIGF3YWl0IHNlcnZlckNsaWVudFxyXG4gICAgICAgIC5mcm9tKFwicGF5bWVudF9tZXRob2RzXCIpXHJcbiAgICAgICAgLnVwZGF0ZSh7IGlzX2RlZmF1bHQ6IGZhbHNlIH0pXHJcbiAgICAgICAgLmVxKFwiY3VycmVuY3lcIiwgdXBkYXRlcy5jdXJyZW5jeSlcclxuICAgICAgICAubmVxKFwiaWRcIiwgaWQpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc2VydmVyQ2xpZW50XHJcbiAgICAgIC5mcm9tKFwicGF5bWVudF9tZXRob2RzXCIpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIGN1cnJlbmN5OiB1cGRhdGVzLmN1cnJlbmN5LFxyXG4gICAgICAgIHR5cGU6IHVwZGF0ZXMudHlwZSxcclxuICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgYWNjb3VudF9uYW1lOiB1cGRhdGVzLmFjY291bnROYW1lLFxyXG4gICAgICAgIGFjY291bnRfbnVtYmVyOiB1cGRhdGVzLmFjY291bnROdW1iZXIsXHJcbiAgICAgICAgYmFua19uYW1lOiB1cGRhdGVzLmJhbmtOYW1lLFxyXG4gICAgICAgIHFyX2NvZGVfZGF0YTogdXBkYXRlcy5xckNvZGVEYXRhLFxyXG4gICAgICAgIGluc3RydWN0aW9uczogdXBkYXRlcy5pbnN0cnVjdGlvbnMsXHJcbiAgICAgICAgaXNfZGVmYXVsdDogdXBkYXRlcy5pc0RlZmF1bHQsXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcShcImlkXCIsIGlkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEZvcmNlIHJlZnJlc2ggcGF5bWVudCBtZXRob2RzIGNhY2hlXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLlBBWU1FTlRfTUVUSE9EUylcclxuXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZVN0YXR1cyhpZDogc3RyaW5nLCBzdGF0dXM6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc2VydmVyQ2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzZXJ2ZXJDbGllbnQuZnJvbShcInBheW1lbnRfbWV0aG9kc1wiKS51cGRhdGUoeyBzdGF0dXMgfSkuZXEoXCJpZFwiLCBpZCkuc2VsZWN0KCkuc2luZ2xlKClcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcblxyXG4gICAgLy8gRm9yY2UgcmVmcmVzaCBwYXltZW50IG1ldGhvZHMgY2FjaGVcclxuICAgIGRhdGFDYWNoZS5pbnZhbGlkYXRlKENBQ0hFX0tFWVMuUEFZTUVOVF9NRVRIT0RTKVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgc2V0RGVmYXVsdChpZDogc3RyaW5nLCBjdXJyZW5jeTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzZXJ2ZXJDbGllbnQgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG5cclxuICAgIC8vIFVuc2V0IG90aGVyIGRlZmF1bHRzIGZvciB0aGUgc2FtZSBjdXJyZW5jeVxyXG4gICAgYXdhaXQgc2VydmVyQ2xpZW50LmZyb20oXCJwYXltZW50X21ldGhvZHNcIikudXBkYXRlKHsgaXNfZGVmYXVsdDogZmFsc2UgfSkuZXEoXCJjdXJyZW5jeVwiLCBjdXJyZW5jeSlcclxuXHJcbiAgICAvLyBTZXQgdGhpcyBvbmUgYXMgZGVmYXVsdFxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc2VydmVyQ2xpZW50XHJcbiAgICAgIC5mcm9tKFwicGF5bWVudF9tZXRob2RzXCIpXHJcbiAgICAgIC51cGRhdGUoeyBpc19kZWZhdWx0OiB0cnVlIH0pXHJcbiAgICAgIC5lcShcImlkXCIsIGlkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEZvcmNlIHJlZnJlc2ggcGF5bWVudCBtZXRob2RzIGNhY2hlXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLlBBWU1FTlRfTUVUSE9EUylcclxuXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGRlbGV0ZShpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzZXJ2ZXJDbGllbnQgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG5cclxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHNlcnZlckNsaWVudC5mcm9tKFwicGF5bWVudF9tZXRob2RzXCIpLmRlbGV0ZSgpLmVxKFwiaWRcIiwgaWQpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG5cclxuICAgIC8vIEZvcmNlIHJlZnJlc2ggcGF5bWVudCBtZXRob2RzIGNhY2hlXHJcbiAgICBkYXRhQ2FjaGUuaW52YWxpZGF0ZShDQUNIRV9LRVlTLlBBWU1FTlRfTUVUSE9EUylcclxuICB9LFxyXG59XHJcblxyXG4vLyBBZG1pbiBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCBhZG1pblNlcnZpY2UgPSB7XHJcbiAgYXN5bmMgdmVyaWZ5QWRtaW4oZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc2VydmVyQ2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuXHJcbiAgICBjb25zdCB7IGRhdGE6IGFkbWluLCBlcnJvciB9ID0gYXdhaXQgc2VydmVyQ2xpZW50XHJcbiAgICAgIC5mcm9tKFwiYWRtaW5fdXNlcnNcIilcclxuICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgLmVxKFwiZW1haWxcIiwgZW1haWwpXHJcbiAgICAgIC5lcShcInN0YXR1c1wiLCBcImFjdGl2ZVwiKVxyXG4gICAgICAuc2luZ2xlKClcclxuXHJcbiAgICBpZiAoZXJyb3IgfHwgIWFkbWluKSByZXR1cm4gbnVsbFxyXG5cclxuICAgIC8vIFNpbmNlIHdlIHJlbW92ZWQgcGFzc3dvcmRfaGFzaCwgd2UgbmVlZCB0byB1c2UgU3VwYWJhc2UgQXV0aCBmb3IgYWRtaW4gbG9naW4gdG9vXHJcbiAgICAvLyBUaGlzIGlzIGEgc2ltcGxpZmllZCBhcHByb2FjaCAtIGluIHByb2R1Y3Rpb24sIHlvdSBtaWdodCB3YW50IHNlcGFyYXRlIGFkbWluIGF1dGhcclxuICAgIHJldHVybiBhZG1pblxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEFsbFRyYW5zYWN0aW9ucyhcclxuICAgIGZpbHRlcnM6IHtcclxuICAgICAgc3RhdHVzPzogc3RyaW5nXHJcbiAgICAgIGN1cnJlbmN5Pzogc3RyaW5nXHJcbiAgICAgIHNlYXJjaD86IHN0cmluZ1xyXG4gICAgICBsaW1pdD86IG51bWJlclxyXG4gICAgfSA9IHt9LFxyXG4gICkge1xyXG4gICAgY29uc3Qgc2VydmVyQ2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICAgIGxldCBxdWVyeSA9IHNlcnZlckNsaWVudC5mcm9tKFwidHJhbnNhY3Rpb25zXCIpLnNlbGVjdChgXHJcbiAgICAgICAgKixcclxuICAgICAgICByZWNpcGllbnQ6cmVjaXBpZW50cygqKSxcclxuICAgICAgICB1c2VyOnVzZXJzKGZpcnN0X25hbWUsIGxhc3RfbmFtZSwgZW1haWwpXHJcbiAgICAgIGApXHJcblxyXG4gICAgaWYgKGZpbHRlcnMuc3RhdHVzICYmIGZpbHRlcnMuc3RhdHVzICE9PSBcImFsbFwiKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoXCJzdGF0dXNcIiwgZmlsdGVycy5zdGF0dXMpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZpbHRlcnMuY3VycmVuY3kgJiYgZmlsdGVycy5jdXJyZW5jeSAhPT0gXCJhbGxcIikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKGBzZW5kX2N1cnJlbmN5LmVxLiR7ZmlsdGVycy5jdXJyZW5jeX0scmVjZWl2ZV9jdXJyZW5jeS5lcS4ke2ZpbHRlcnMuY3VycmVuY3l9YClcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycy5zZWFyY2gpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5vcihgdHJhbnNhY3Rpb25faWQuaWxpa2UuJSR7ZmlsdGVycy5zZWFyY2h9JSx1c2VyLmVtYWlsLmlsaWtlLiUke2ZpbHRlcnMuc2VhcmNofSVgKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5Lm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSkubGltaXQoZmlsdGVycy5saW1pdCB8fCA1MClcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEFsbFVzZXJzKFxyXG4gICAgZmlsdGVyczoge1xyXG4gICAgICBzdGF0dXM/OiBzdHJpbmdcclxuICAgICAgdmVyaWZpY2F0aW9uPzogc3RyaW5nXHJcbiAgICAgIHNlYXJjaD86IHN0cmluZ1xyXG4gICAgICBsaW1pdD86IG51bWJlclxyXG4gICAgfSA9IHt9LFxyXG4gICkge1xyXG4gICAgY29uc3Qgc2VydmVyQ2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuICAgIGxldCBxdWVyeSA9IHNlcnZlckNsaWVudC5mcm9tKFwidXNlcnNcIikuc2VsZWN0KFwiKlwiKVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLnN0YXR1cyAmJiBmaWx0ZXJzLnN0YXR1cyAhPT0gXCJhbGxcIikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKFwic3RhdHVzXCIsIGZpbHRlcnMuc3RhdHVzKVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLnZlcmlmaWNhdGlvbiAmJiBmaWx0ZXJzLnZlcmlmaWNhdGlvbiAhPT0gXCJhbGxcIikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKFwidmVyaWZpY2F0aW9uX3N0YXR1c1wiLCBmaWx0ZXJzLnZlcmlmaWNhdGlvbilcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycy5zZWFyY2gpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5vcihcclxuICAgICAgICBgZW1haWwuaWxpa2UuJSR7ZmlsdGVycy5zZWFyY2h9JSxmaXJzdF9uYW1lLmlsaWtlLiUke2ZpbHRlcnMuc2VhcmNofSUsbGFzdF9uYW1lLmlsaWtlLiUke2ZpbHRlcnMuc2VhcmNofSVgLFxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnkub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KS5saW1pdChmaWx0ZXJzLmxpbWl0IHx8IDUwKVxyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxufVxyXG5cclxuLy8gU3lzdGVtIHNldHRpbmdzIG9wZXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IHNldHRpbmdzU2VydmljZSA9IHtcclxuICBhc3luYyBnZXQoa2V5OiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oXCJzeXN0ZW1fc2V0dGluZ3NcIikuc2VsZWN0KFwidmFsdWUsIGRhdGFfdHlwZVwiKS5lcShcImtleVwiLCBrZXkpLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiUEdSU1QxMTZcIikgdGhyb3cgZXJyb3JcclxuXHJcbiAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsXHJcblxyXG4gICAgLy8gUGFyc2UgdmFsdWUgYmFzZWQgb24gZGF0YSB0eXBlXHJcbiAgICBzd2l0Y2ggKGRhdGEuZGF0YV90eXBlKSB7XHJcbiAgICAgIGNhc2UgXCJib29sZWFuXCI6XHJcbiAgICAgICAgcmV0dXJuIGRhdGEudmFsdWUgPT09IFwidHJ1ZVwiXHJcbiAgICAgIGNhc2UgXCJudW1iZXJcIjpcclxuICAgICAgICByZXR1cm4gTnVtYmVyKGRhdGEudmFsdWUpXHJcbiAgICAgIGNhc2UgXCJqc29uXCI6XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YS52YWx1ZSlcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gZGF0YS52YWx1ZVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgZGF0YVR5cGUgPSBcInN0cmluZ1wiKSB7XHJcbiAgICBjb25zdCBzZXJ2ZXJDbGllbnQgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxyXG5cclxuICAgIC8vIENvbnZlcnQgdmFsdWUgdG8gc3RyaW5nIGZvciBzdG9yYWdlXHJcbiAgICBsZXQgc3RyaW5nVmFsdWU6IHN0cmluZ1xyXG4gICAgc3dpdGNoIChkYXRhVHlwZSkge1xyXG4gICAgICBjYXNlIFwiYm9vbGVhblwiOlxyXG4gICAgICAgIHN0cmluZ1ZhbHVlID0gdmFsdWUgPyBcInRydWVcIiA6IFwiZmFsc2VcIlxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgXCJudW1iZXJcIjpcclxuICAgICAgICBzdHJpbmdWYWx1ZSA9IFN0cmluZyh2YWx1ZSlcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlIFwianNvblwiOlxyXG4gICAgICAgIHN0cmluZ1ZhbHVlID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBzdHJpbmdWYWx1ZSA9IFN0cmluZyh2YWx1ZSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzZXJ2ZXJDbGllbnRcclxuICAgICAgLmZyb20oXCJzeXN0ZW1fc2V0dGluZ3NcIilcclxuICAgICAgLnVwc2VydCh7XHJcbiAgICAgICAga2V5LFxyXG4gICAgICAgIHZhbHVlOiBzdHJpbmdWYWx1ZSxcclxuICAgICAgICBkYXRhX3R5cGU6IGRhdGFUeXBlLFxyXG4gICAgICB9KVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBnZXRBbGwoKSB7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKFwic3lzdGVtX3NldHRpbmdzXCIpLnNlbGVjdChcIipcIikub3JkZXIoXCJrZXlcIilcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGdldEJ5Q2F0ZWdvcnkoY2F0ZWdvcnk6IHN0cmluZykge1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJzeXN0ZW1fc2V0dGluZ3NcIilcclxuICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgLmVxKFwiY2F0ZWdvcnlcIiwgY2F0ZWdvcnkpXHJcbiAgICAgIC5lcShcImlzX2FjdGl2ZVwiLCB0cnVlKVxyXG4gICAgICAub3JkZXIoXCJrZXlcIilcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZU11bHRpcGxlKHNldHRpbmdzOiBBcnJheTx7IGtleTogc3RyaW5nOyB2YWx1ZTogYW55OyBkYXRhVHlwZT86IHN0cmluZyB9Pikge1xyXG4gICAgY29uc3Qgc2VydmVyQ2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KClcclxuXHJcbiAgICBjb25zdCB1cGRhdGVzID0gc2V0dGluZ3MubWFwKCh7IGtleSwgdmFsdWUsIGRhdGFUeXBlID0gXCJzdHJpbmdcIiB9KSA9PiB7XHJcbiAgICAgIGxldCBzdHJpbmdWYWx1ZTogc3RyaW5nXHJcbiAgICAgIHN3aXRjaCAoZGF0YVR5cGUpIHtcclxuICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxyXG4gICAgICAgICAgc3RyaW5nVmFsdWUgPSB2YWx1ZSA/IFwidHJ1ZVwiIDogXCJmYWxzZVwiXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgXCJudW1iZXJcIjpcclxuICAgICAgICAgIHN0cmluZ1ZhbHVlID0gU3RyaW5nKHZhbHVlKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlIFwianNvblwiOlxyXG4gICAgICAgICAgc3RyaW5nVmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHN0cmluZ1ZhbHVlID0gU3RyaW5nKHZhbHVlKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4geyBrZXksIHZhbHVlOiBzdHJpbmdWYWx1ZSwgZGF0YV90eXBlOiBkYXRhVHlwZSB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHNlcnZlckNsaWVudC5mcm9tKFwic3lzdGVtX3NldHRpbmdzXCIpLnVwc2VydCh1cGRhdGVzKS5zZWxlY3QoKVxyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxufVxyXG4iXSwibmFtZXMiOlsic3VwYWJhc2UiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJkYXRhQ2FjaGUiLCJDQUNIRV9LRVlTIiwidXNlclNlcnZpY2UiLCJmaW5kQnlFbWFpbCIsImVtYWlsIiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiY29kZSIsInVwZGF0ZVByb2ZpbGUiLCJ1c2VySWQiLCJ1cGRhdGVzIiwidXBkYXRlIiwiZmlyc3RfbmFtZSIsImZpcnN0TmFtZSIsImxhc3RfbmFtZSIsImxhc3ROYW1lIiwicGhvbmUiLCJiYXNlX2N1cnJlbmN5IiwiYmFzZUN1cnJlbmN5IiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImludmFsaWRhdGUiLCJVU0VSX1BST0ZJTEUiLCJnZXRTdGF0cyIsInRvdGFsVXNlcnMiLCJjb3VudCIsImFjdGl2ZVVzZXJzIiwidmVyaWZpZWRVc2VycyIsInRvdGFsIiwibGVuZ3RoIiwiYWN0aXZlIiwidmVyaWZpZWQiLCJjdXJyZW5jeVNlcnZpY2UiLCJnZXRBbGwiLCJyZWZyZXNoRm4iLCJvcmRlciIsIm1hcCIsImN1cnJlbmN5IiwiZmxhZyIsImZsYWdfc3ZnIiwiY2FjaGVkIiwiZ2V0V2l0aFJlZnJlc2giLCJDVVJSRU5DSUVTIiwiY3VycmVuY2llcyIsInNldCIsImdldEV4Y2hhbmdlUmF0ZXMiLCJyYXRlIiwiZnJvbV9jdXJyZW5jeV9pbmZvIiwidW5kZWZpbmVkIiwidG9fY3VycmVuY3lfaW5mbyIsIkVYQ0hBTkdFX1JBVEVTIiwicmF0ZXMiLCJnZXRSYXRlIiwiZnJvbUN1cnJlbmN5IiwidG9DdXJyZW5jeSIsInVwZGF0ZVJhdGUiLCJmZWVUeXBlIiwiZmVlQW1vdW50IiwidXBzZXJ0IiwiZnJvbV9jdXJyZW5jeSIsInRvX2N1cnJlbmN5IiwiZmVlX3R5cGUiLCJmZWVfYW1vdW50Iiwic3RhdHVzIiwicmVjaXBpZW50U2VydmljZSIsImNyZWF0ZSIsInJlY2lwaWVudERhdGEiLCJpbnNlcnQiLCJ1c2VyX2lkIiwiZnVsbF9uYW1lIiwiZnVsbE5hbWUiLCJhY2NvdW50X251bWJlciIsImFjY291bnROdW1iZXIiLCJiYW5rX25hbWUiLCJiYW5rTmFtZSIsInBob25lX251bWJlciIsInBob25lTnVtYmVyIiwiVVNFUl9SRUNJUElFTlRTIiwiZ2V0QnlVc2VySWQiLCJyZXF1ZXN0aW5nVXNlcklkIiwiRXJyb3IiLCJhc2NlbmRpbmciLCJyZWNpcGllbnRzIiwicmVjaXBpZW50SWQiLCJpbnZhbGlkYXRlUGF0dGVybiIsImRlbGV0ZSIsInRyYW5zYWN0aW9uU2VydmljZSIsInRyYW5zYWN0aW9uRGF0YSIsInRyYW5zYWN0aW9uSWQiLCJub3ciLCJ0aW1lb3V0UHJvbWlzZSIsIlByb21pc2UiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsImNyZWF0ZVByb21pc2UiLCJ0cmFuc2FjdGlvbl9pZCIsInJlY2lwaWVudF9pZCIsInNlbmRfYW1vdW50Iiwic2VuZEFtb3VudCIsInNlbmRfY3VycmVuY3kiLCJzZW5kQ3VycmVuY3kiLCJyZWNlaXZlX2Ftb3VudCIsInJlY2VpdmVBbW91bnQiLCJyZWNlaXZlX2N1cnJlbmN5IiwicmVjZWl2ZUN1cnJlbmN5IiwiZXhjaGFuZ2VfcmF0ZSIsImV4Y2hhbmdlUmF0ZSIsInRvdGFsX2Ftb3VudCIsInRvdGFsQW1vdW50IiwicmVmZXJlbmNlIiwicmFjZSIsIlVTRVJfVFJBTlNBQ1RJT05TIiwiY29uc29sZSIsImxpbWl0IiwidHJhbnNhY3Rpb25zIiwiZ2V0QnlJZCIsIlRSQU5TQUNUSU9OIiwidHJhbnNhY3Rpb24iLCJ0dGwiLCJ1cGRhdGVTdGF0dXMiLCJjb21wbGV0ZWRfYXQiLCJ1cGxvYWRSZWNlaXB0IiwiZmlsZSIsImNoZWNrUHJvbWlzZSIsImV4aXN0aW5nVHJhbnNhY3Rpb24iLCJjaGVja0Vycm9yIiwiZmlsZUV4dCIsIm5hbWUiLCJzcGxpdCIsInBvcCIsImZpbGVOYW1lIiwiZmlsZVBhdGgiLCJ1cGxvYWRUaW1lb3V0UHJvbWlzZSIsInVwbG9hZFByb21pc2UiLCJzdG9yYWdlIiwidXBsb2FkIiwiY2FjaGVDb250cm9sIiwidXBsb2FkRGF0YSIsInVwbG9hZEVycm9yIiwibWVzc2FnZSIsInB1YmxpY1VybCIsImdldFB1YmxpY1VybCIsInVwZGF0ZVRpbWVvdXRQcm9taXNlIiwidXBkYXRlUHJvbWlzZSIsInJlY2VpcHRfdXJsIiwicmVjZWlwdF9maWxlbmFtZSIsInVwZGF0ZWRUcmFuc2FjdGlvbiIsInRpbWVSYW5nZSIsImRhdGVGaWx0ZXIiLCJzZXRIb3VycyIsInNldERhdGUiLCJnZXREYXRlIiwic2V0TW9udGgiLCJnZXRNb250aCIsImd0ZSIsInBlbmRpbmdUcmFuc2FjdGlvbnMiLCJpbiIsInRvdGFsVm9sdW1lIiwicmVkdWNlIiwic3VtIiwidCIsIk51bWJlciIsInRvdGFsVHJhbnNhY3Rpb25zIiwicGF5bWVudE1ldGhvZFNlcnZpY2UiLCJQQVlNRU5UX01FVEhPRFMiLCJtZXRob2RzIiwiZ2V0QnlDdXJyZW5jeSIsImFsbE1ldGhvZHMiLCJmaWx0ZXIiLCJwbSIsInBheW1lbnRNZXRob2REYXRhIiwic2VydmVyQ2xpZW50IiwiaXNEZWZhdWx0IiwiaXNfZGVmYXVsdCIsInR5cGUiLCJhY2NvdW50X25hbWUiLCJhY2NvdW50TmFtZSIsInFyX2NvZGVfZGF0YSIsInFyQ29kZURhdGEiLCJpbnN0cnVjdGlvbnMiLCJpZCIsIm5lcSIsInNldERlZmF1bHQiLCJhZG1pblNlcnZpY2UiLCJ2ZXJpZnlBZG1pbiIsInBhc3N3b3JkIiwiYWRtaW4iLCJnZXRBbGxUcmFuc2FjdGlvbnMiLCJmaWx0ZXJzIiwicXVlcnkiLCJvciIsInNlYXJjaCIsImdldEFsbFVzZXJzIiwidmVyaWZpY2F0aW9uIiwic2V0dGluZ3NTZXJ2aWNlIiwiZ2V0Iiwia2V5IiwiZGF0YV90eXBlIiwidmFsdWUiLCJKU09OIiwicGFyc2UiLCJkYXRhVHlwZSIsInN0cmluZ1ZhbHVlIiwiU3RyaW5nIiwic3RyaW5naWZ5IiwiZ2V0QnlDYXRlZ29yeSIsImNhdGVnb3J5IiwidXBkYXRlTXVsdGlwbGUiLCJzZXR0aW5ncyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/database.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerClient: () => (/* binding */ createServerClient),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   signOut: () => (/* binding */ signOut),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://seeqjiebmrnolcyydewj.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNlZXFqaWVibXJub2xjeXlkZXdqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2OTIxMTksImV4cCI6MjA2OTI2ODExOX0.7wc1OxdPCuhpBgPZY-pQAdjjOO8VbKdb3O47IQjd4Fc\";\nif (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error(\"Missing Supabase environment variables\");\n}\n// Client-side Supabase client (singleton pattern)\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey, {\n    auth: {\n        persistSession: true,\n        autoRefreshToken: true,\n        detectSessionInUrl: true\n    },\n    global: {\n        headers: {\n            \"X-Client-Info\": \"easner-web-app\"\n        }\n    }\n});\n// Server-side client for admin operations\nconst createServerClient = ()=>{\n    const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!serviceRoleKey) {\n        throw new Error(\"Missing SUPABASE_SERVICE_ROLE_KEY environment variable\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, serviceRoleKey, {\n        auth: {\n            persistSession: false,\n            autoRefreshToken: false\n        }\n    });\n};\n// Auth helper functions\nconst getCurrentUser = async ()=>{\n    const { data: { user }, error } = await supabase.auth.getUser();\n    if (error) throw error;\n    return user;\n};\nconst signOut = async ()=>{\n    const { error } = await supabase.auth.signOut();\n    if (error) throw error;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBb0Q7QUFFcEQsTUFBTUMsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO0FBRWpFLElBQUksQ0FBQ0QsZUFBZSxDQUFDSSxpQkFBaUI7SUFDcEMsTUFBTSxJQUFJRSxNQUFNO0FBQ2xCO0FBRUEsa0RBQWtEO0FBQzNDLE1BQU1DLFdBQVdSLG1FQUFZQSxDQUFDQyxhQUFhSSxpQkFBaUI7SUFDakVJLE1BQU07UUFDSkMsZ0JBQWdCO1FBQ2hCQyxrQkFBa0I7UUFDbEJDLG9CQUFvQjtJQUN0QjtJQUNBQyxRQUFRO1FBQ05DLFNBQVM7WUFDUCxpQkFBaUI7UUFDbkI7SUFDRjtBQUNGLEdBQUU7QUFFRiwwQ0FBMEM7QUFDbkMsTUFBTUMscUJBQXFCO0lBQ2hDLE1BQU1DLGlCQUFpQmQsUUFBUUMsR0FBRyxDQUFDYyx5QkFBeUI7SUFFNUQsSUFBSSxDQUFDRCxnQkFBZ0I7UUFDbkIsTUFBTSxJQUFJVCxNQUFNO0lBQ2xCO0lBRUEsT0FBT1AsbUVBQVlBLENBQUNDLGFBQWFlLGdCQUFnQjtRQUMvQ1AsTUFBTTtZQUNKQyxnQkFBZ0I7WUFDaEJDLGtCQUFrQjtRQUNwQjtJQUNGO0FBQ0YsRUFBQztBQUVELHdCQUF3QjtBQUNqQixNQUFNTyxpQkFBaUI7SUFDNUIsTUFBTSxFQUNKQyxNQUFNLEVBQUVDLElBQUksRUFBRSxFQUNkQyxLQUFLLEVBQ04sR0FBRyxNQUFNYixTQUFTQyxJQUFJLENBQUNhLE9BQU87SUFDL0IsSUFBSUQsT0FBTyxNQUFNQTtJQUNqQixPQUFPRDtBQUNULEVBQUM7QUFFTSxNQUFNRyxVQUFVO0lBQ3JCLE1BQU0sRUFBRUYsS0FBSyxFQUFFLEdBQUcsTUFBTWIsU0FBU0MsSUFBSSxDQUFDYyxPQUFPO0lBQzdDLElBQUlGLE9BQU8sTUFBTUE7QUFDbkIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2Vhc25lci8uL2xpYi9zdXBhYmFzZS50cz9jOTlmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIlxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCFcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIVxuXG5pZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUFub25LZXkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcIilcbn1cblxuLy8gQ2xpZW50LXNpZGUgU3VwYWJhc2UgY2xpZW50IChzaW5nbGV0b24gcGF0dGVybilcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5LCB7XG4gIGF1dGg6IHtcbiAgICBwZXJzaXN0U2Vzc2lvbjogdHJ1ZSxcbiAgICBhdXRvUmVmcmVzaFRva2VuOiB0cnVlLFxuICAgIGRldGVjdFNlc3Npb25JblVybDogdHJ1ZSwgLy8gQmV0dGVyIHNlc3Npb24gZGV0ZWN0aW9uIGZvciBSTFNcbiAgfSxcbiAgZ2xvYmFsOiB7XG4gICAgaGVhZGVyczoge1xuICAgICAgJ1gtQ2xpZW50LUluZm8nOiAnZWFzbmVyLXdlYi1hcHAnXG4gICAgfVxuICB9XG59KVxuXG4vLyBTZXJ2ZXItc2lkZSBjbGllbnQgZm9yIGFkbWluIG9wZXJhdGlvbnNcbmV4cG9ydCBjb25zdCBjcmVhdGVTZXJ2ZXJDbGllbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHNlcnZpY2VSb2xlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWVxuXG4gIGlmICghc2VydmljZVJvbGVLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIFNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGVcIilcbiAgfVxuXG4gIHJldHVybiBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHNlcnZpY2VSb2xlS2V5LCB7XG4gICAgYXV0aDoge1xuICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxuICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgfSxcbiAgfSlcbn1cblxuLy8gQXV0aCBoZWxwZXIgZnVuY3Rpb25zXG5leHBvcnQgY29uc3QgZ2V0Q3VycmVudFVzZXIgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICBlcnJvcixcbiAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgcmV0dXJuIHVzZXJcbn1cblxuZXhwb3J0IGNvbnN0IHNpZ25PdXQgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3Jcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIkVycm9yIiwic3VwYWJhc2UiLCJhdXRoIiwicGVyc2lzdFNlc3Npb24iLCJhdXRvUmVmcmVzaFRva2VuIiwiZGV0ZWN0U2Vzc2lvbkluVXJsIiwiZ2xvYmFsIiwiaGVhZGVycyIsImNyZWF0ZVNlcnZlckNsaWVudCIsInNlcnZpY2VSb2xlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImdldEN1cnJlbnRVc2VyIiwiZGF0YSIsInVzZXIiLCJlcnJvciIsImdldFVzZXIiLCJzaWduT3V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftransactions%2Froute&page=%2Fapi%2Ftransactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftransactions%2Froute.ts&appDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CUsers%5Cenyoc%5CDocuments%5CDev%5Ceasner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();